"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[325],{8109:function(e,l,t){function a(e,l){if(console.log("tableToExcel",e,l),0==e.length)throw"无数据";let t="\r\n";t+=Object.keys(e[0]).join(",")+"\r\n";for(let o=0;o<e.length;o++){for(const l in e[o]){let a=e[o][l];"string"==typeof a?t+=`${a},`:(a=JSON.stringify(a).replaceAll('"','""'),t+=`"${a}",`)}t+="\r\n"}const a="data:text/csv;charset=utf-8,"+encodeURIComponent(t),i=document.createElement("a");i.href=a,i.download=l+".csv",i.click()}t.d(l,{G:function(){return a}})},3625:function(e,l,t){t.r(l),t.d(l,{default:function(){return d}});var a=t(6252);function i(e,l,t,i,o,s){const r=(0,a.up)("el-input"),d=(0,a.up)("el-form-item"),n=(0,a.up)("el-input-number"),u=(0,a.up)("el-switch"),m=(0,a.up)("el-form"),c=(0,a.up)("el-button"),p=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(p,{title:o.titleMap[o.mode],modelValue:o.visible,"onUpdate:modelValue":l[10]||(l[10]=e=>o.visible=e),width:500,"destroy-on-close":"",onClosed:l[11]||(l[11]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(c,{onClick:l[8]||(l[8]=e=>o.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),"show"!=o.mode?((0,a.wg)(),(0,a.j4)(c,{key:0,type:"primary",loading:o.isSaveing,onClick:l[9]||(l[9]=e=>s.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])):(0,a.kq)("",!0)])),default:(0,a.w5)((()=>[(0,a.Wm)(m,{model:o.form,rules:o.rules,disabled:"show"==o.mode,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"登录名",prop:"username"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.username,"onUpdate:modelValue":l[0]||(l[0]=e=>o.form.username=e),placeholder:"用于登录系统",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.name,"onUpdate:modelValue":l[1]||(l[1]=e=>o.form.name=e),placeholder:"名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"登录密码",prop:"password"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{type:"password",modelValue:o.form.password,"onUpdate:modelValue":l[2]||(l[2]=e=>o.form.password=e),clearable:"","show-password":""},null,8,["modelValue"])])),_:1}),"add"==o.mode?((0,a.wg)(),(0,a.j4)(d,{key:0,label:"确认密码",prop:"password2"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{type:"password",modelValue:o.form.password2,"onUpdate:modelValue":l[3]||(l[3]=e=>o.form.password2=e),clearable:"","show-password":""},null,8,["modelValue"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(d,{label:"联系方式",prop:"contact"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.contact,"onUpdate:modelValue":l[4]||(l[4]=e=>o.form.contact=e),placeholder:"联系方式",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"余额",prop:"card_cash"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.card_cash,"onUpdate:modelValue":l[5]||(l[5]=e=>o.form.card_cash=e),placeholder:"余额",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"折扣",prop:"discount"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.discount,"onUpdate:modelValue":l[6]||(l[6]=e=>o.form.discount=e),placeholder:"折扣 %",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"是否启用",prop:"sign"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.form.sign,"onUpdate:modelValue":l[7]||(l[7]=e=>o.form.sign=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules","disabled"])])),_:1},8,["title","modelValue"])}var o={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增用户",edit:"编辑用户",show:"查看"},visible:!1,isSaveing:!1,form:{username:"",name:"",password:"",password2:"",contact:"",card_cash:0,discount:100,sign:1},rules:{username:[{required:!0,message:"请输入登录账号"}],password:[{required:!0,message:"请输入登录密码"},{validator:(e,l,t)=>{""!==this.form.password2&&this.$refs.dialogForm.validateField("password2"),t()}}],password2:[{required:!0,message:"请再次输入密码"},{validator:(e,l,t)=>{l!==this.form.password?t(new Error("两次输入密码不一致!")):t()}}],contact:[{required:!0,message:"请输入联系方式"}]},roles:[],rolesProps:{value:"id",multiple:!0,checkStrictly:!0}}},mounted(){this.getDept()},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},choiceRole(e){for(let l of this.roles)if(l.id==e){this.form.roles=l.alias;break}},async getRoles(){let e={page:1,pageSize:100};var l=await this.$API.system.role.list.get(e);this.roles=l.data.rows},async getDept(){},submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;try{this.isSaveing=!0;let e=Object.assign({},this.form);delete e["password2"],await this.$API.card.agent.new.post(e),this.$emit("success",this.form,this.mode),this.visible=!1,this.$store.dispatch("fetch_cash"),this.$message.success("操作成功")}catch(l){}this.isSaveing=!1}))},setData(e){Object.assign(this.form,e)}}},s=t(3744);const r=(0,s.Z)(o,[["render",i]]);var d=r},7968:function(e,l,t){t.r(l),t.d(l,{default:function(){return m}});var a=t(6252),i=t(3577);const o={class:"flex justify-between"};function s(e,l,t,s,r,d){const n=(0,a.up)("el-option"),u=(0,a.up)("el-select"),m=(0,a.up)("el-form-item"),c=(0,a.up)("el-input-number"),p=(0,a.up)("el-form"),f=(0,a.up)("el-button"),h=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(h,{title:r.titleMap[r.mode],modelValue:r.visible,"onUpdate:modelValue":l[4]||(l[4]=e=>r.visible=e),width:500,"destroy-on-close":"",onClosed:l[5]||(l[5]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(f,{onClick:l[2]||(l[2]=e=>r.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(f,{type:"primary",loading:r.isSaveing,onClick:l[3]||(l[3]=e=>d.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("确 认")])),_:1},8,["loading"])])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{model:r.form,rules:r.rules,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{label:"生成类型",prop:"card_type_id"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:r.form.card_type_id,"onUpdate:modelValue":l[0]||(l[0]=e=>r.form.card_type_id=e),placeholder:"Select"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.data,(e=>((0,a.wg)(),(0,a.j4)(n,{key:e.id,label:e.name,value:e.id},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a._)("span",null,(0,i.zw)(e.name),1),(0,a._)("span",null,(0,i.zw)(e.price)+"￥",1)])])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(m,{label:"生成数量",prop:"card_num"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:r.form.card_num,"onUpdate:modelValue":l[1]||(l[1]=e=>r.form.card_num=e),"controls-position":"right",min:1,max:50,clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var r=t(9737),d={props:["data"],emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增参数",edit:"编辑参数"},form:{card_type_id:2,card_num:1},rules:{card_type_id:[{required:!0,message:"请输入类型"}],card_num:[{required:!0,message:"请输入数量"}]},visible:!1,isSaveing:!1}},mounted(){},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;try{let e=await this.$API.card.mycard.gen.post(this.form);console.log(e),this.visible=!1,this.$emit("success"),this.$message.success("操作成功");let l=e.data.uuids.join("<br/>");r.T.alert(`此次消费【${e.data.total_price}】 生成卡密【${e.data.uuids.length} 】张<br/>`+l,"生成成功",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认 ",callback:e=>{console.log(e)}})}catch(l){}finally{this.isSaveing=!1}}}))},setData(e){this.form=this.$TOOL.objCopy(e)}}},n=t(3744);const u=(0,n.Z)(d,[["render",s]]);var m=u},4186:function(e,l,t){t.r(l),t.d(l,{default:function(){return m}});var a=t(6252),i=t(3577);const o={class:"flex justify-between"};function s(e,l,t,s,r,d){const n=(0,a.up)("el-option"),u=(0,a.up)("el-select"),m=(0,a.up)("el-form-item"),c=(0,a.up)("el-input-number"),p=(0,a.up)("el-form"),f=(0,a.up)("el-button"),h=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(h,{title:r.titleMap[r.mode],modelValue:r.visible,"onUpdate:modelValue":l[4]||(l[4]=e=>r.visible=e),width:500,"destroy-on-close":"",onClosed:l[5]||(l[5]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(f,{onClick:l[2]||(l[2]=e=>r.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(f,{type:"primary",loading:r.isSaveing,onClick:l[3]||(l[3]=e=>d.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("确 认")])),_:1},8,["loading"])])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{model:r.form,rules:r.rules,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{label:"生成类型",prop:"card_type_id"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:r.form.card_type_id,"onUpdate:modelValue":l[0]||(l[0]=e=>r.form.card_type_id=e),placeholder:"Select"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.data,(e=>((0,a.wg)(),(0,a.j4)(n,{key:e.id,label:e.name,value:e.id},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a._)("span",null,(0,i.zw)(e.name),1),(0,a._)("span",null,(0,i.zw)(e.price)+"￥",1)])])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(m,{label:"生成数量",prop:"card_num"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:r.form.card_num,"onUpdate:modelValue":l[1]||(l[1]=e=>r.form.card_num=e),"controls-position":"right",min:1,max:50,clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var r=t(9737),d={props:["data"],emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增参数",edit:"编辑参数"},form:{card_type_id:2,card_num:1},rules:{card_type_id:[{required:!0,message:"请输入类型"}],card_num:[{required:!0,message:"请输入数量"}]},visible:!1,isSaveing:!1}},mounted(){},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;try{let e=await this.$API.card.mycard.gen.post(this.form);console.log(e),this.visible=!1,this.$emit("success"),this.$message.success("操作成功");let l=e.data.uuids.join("<br/>");r.T.alert(`此次消费【${e.data.total_price}】 生成卡密【${e.data.uuids.length} 】张<br/>`+l,"生成成功",{dangerouslyUseHTMLString:!0,confirmButtonText:"确认 ",callback:e=>{console.log(e)}})}catch(l){}finally{this.isSaveing=!1}}}))},setData(e){this.form=this.$TOOL.objCopy(e)}}},n=t(3744);const u=(0,n.Z)(d,[["render",s]]);var m=u},8204:function(e,l,t){t.r(l),t.d(l,{default:function(){return m}});var a=t(6252);const i=e=>((0,a.dD)("data-v-55958ae3"),e=e(),(0,a.Cn)(),e),o=i((()=>(0,a._)("h2",null,"无日志",-1))),s=i((()=>(0,a._)("p",{style:{"font-size":"14px",color:"#999","line-height":"1.5",margin:"0 40px"}},"未查询到相关日志",-1)));function r(e,l,t,i,r,d){const n=(0,a.up)("el-empty"),u=(0,a.up)("el-table-column"),m=(0,a.up)("el-table"),c=(0,a.up)("el-main"),p=(0,a.up)("el-button"),f=(0,a.up)("el-footer"),h=(0,a.up)("el-container"),b=(0,a.Q2)("loading");return(0,a.wy)(((0,a.wg)(),(0,a.j4)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[0==r.logs.length?((0,a.wg)(),(0,a.j4)(n,{key:0,"image-size":120},{description:(0,a.w5)((()=>[o])),default:(0,a.w5)((()=>[s])),_:1})):((0,a.wg)(),(0,a.j4)(m,{key:1,data:r.logs,stripe:"",style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{prop:"username",label:"操作角色",width:"80"}),(0,a.Wm)(u,{prop:"data",label:"参数",width:"180"}),(0,a.Wm)(u,{prop:"changed",label:"修改数据",width:"180"}),(0,a.Wm)(u,{prop:"name",label:"操作",width:"100"}),(0,a.Wm)(u,{prop:"start_time",label:"修改时间"})])),_:1},8,["data"]))])),_:1}),(0,a.Wm)(f,{style:{padding:"10px","text-align":"right"}},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{circle:"",icon:"el-icon-refresh",onClick:d.refresh},null,8,["onClick"])])),_:1})])),_:1})),[[b,r.loading]])}var d={data(){return{loading:!1,logs:[],form:{}}},mounted(){},methods:{setForm(e){Object.assign(this.form,e),this.getData()},async getData(){try{this.loading=!0;var e=await this.$API.system.log.filter.post(this.form);this.logs=e.data}catch(l){}this.loading=!1},refresh(){this.getData()},download(e){let l=document.createElement("a");l.style="display: none",l.target="_blank",l.href=e.result,document.body.appendChild(l),l.click(),document.body.removeChild(l)}}},n=t(3744);const u=(0,n.Z)(d,[["render",r],["__scopeId","data-v-55958ae3"]]);var m=u},8564:function(e,l,t){t.r(l),t.d(l,{default:function(){return n}});var a=t(6252),i=t(3577);function o(e,l,t,o,s,r){const d=(0,a.up)("el-link"),n=(0,a.up)("el-button"),u=(0,a.up)("sc-upload-file"),m=(0,a.up)("el-card"),c=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(c,{title:t.title,modelValue:s.visible,"onUpdate:modelValue":l[2]||(l[2]=e=>s.visible=e),width:500},{footer:(0,a.w5)((()=>[(0,a.Wm)(n,{onClick:l[1]||(l[1]=e=>s.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(n,{type:"primary",loading:s.isSaveing,onClick:r.submit},{default:(0,a.w5)((()=>[(0,a.Uk)("开始导入")])),_:1},8,["loading","onClick"])])),default:(0,a.w5)((()=>[""!=t.modname?((0,a.wg)(),(0,a.j4)(d,{key:0,class:"h-8 m-2 p-2",href:"static/"+t.modname+"模板.xlsx",type:"primary"},{default:(0,a.w5)((()=>[(0,a.Uk)("下载"+(0,i.zw)(t.modname)+"模板",1)])),_:1},8,["href"])):(0,a.kq)("",!0),(0,a.Wm)(m,{shadow:"never",header:"上传文件"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:s.file,"onUpdate:modelValue":l[0]||(l[0]=e=>s.file=e),accept:t.accept,limit:1,data:s.form,tip:t.tip},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{type:"primary",icon:"el-icon-upload"},{default:(0,a.w5)((()=>[(0,a.Uk)("上传文件")])),_:1})])),_:1},8,["modelValue","accept","data","tip"])])),_:1})])),_:1},8,["title","modelValue"])}var s={props:{data:{type:Object,default:()=>{}},modname:{type:String,default:""},apiObj:{type:Object,default:()=>{}},title:{type:String,default:"导入数据"},tip:{type:String,default:"最多上传1个文件,不要超过10M,请上传xlsx格式文件"},accept:{type:String,default:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"}},emits:["success"],data(){return{mode:"add",file:[],form:{path:"import"},visible:!1,isSaveing:!1}},methods:{open(){return this.visible=!0,this},async submit(){this.isSaveing=!0;try{let e={filepath:this.file[0].src};await this.apiObj.post(e),this.file="",this.visible=!1,this.$emit("success"),this.$message.success("操作成功")}catch(e){}finally{this.isSaveing=!1}},setData(e,l){this.index=l,this.form=this.$TOOL.objCopy(e)},selectParms(e,l){for(let t of this.data)if(t.id==e){this.form.conflict[l]["superior"]=t.superior,this.form.conflict[l]["name"]=t.name;break}}}},r=t(3744);const d=(0,r.Z)(s,[["render",o]]);var n=d},7973:function(e,l,t){t.r(l),t.d(l,{default:function(){return g}});var a=t(6252),i=t(3577);const o={class:"common-header-left"},s={class:"common-header-logo"},r=["alt"],d={class:"common-header-title"},n={class:"common-header-right"},u={class:"common-container"},m={class:"common-title"},c={class:"common-main el-card"};function p(e,l,t,p,f,h){const b=(0,a.up)("router-link"),g=(0,a.up)("el-header"),w=(0,a.up)("el-main"),v=(0,a.up)("el-container");return(0,a.wg)(),(0,a.j4)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{style:{height:"50px"}},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a._)("div",s,[(0,a._)("img",{alt:e.$CONFIG.APP_NAME,src:"img/logo.png"},null,8,r),(0,a._)("label",null,(0,i.zw)(e.$CONFIG.APP_NAME),1)]),(0,a._)("div",d,(0,i.zw)(t.title),1)]),(0,a._)("div",n,[(0,a.Wm)(b,{to:"/login"},{default:(0,a.w5)((()=>[(0,a.Uk)("返回登录")])),_:1})])])),_:1}),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a._)("div",u,[(0,a._)("h2",m,(0,i.zw)(t.title),1),(0,a._)("div",c,[(0,a.WI)(e.$slots,"default")])])])),_:3})])),_:3})}var f={props:{title:{type:String,default:""}}},h=t(3744);const b=(0,h.Z)(f,[["render",p]]);var g=b},2795:function(e,l,t){t.r(l),t.d(l,{default:function(){return u}});var a=t(6252),i=t(9963),o=t(3577);function s(e,l,t,s,r,d){const n=(0,a.up)("el-input"),u=(0,a.up)("el-form-item"),m=(0,a.up)("el-checkbox"),c=(0,a.up)("el-col"),p=(0,a.up)("el-button"),f=(0,a.up)("el-form");return(0,a.wg)(),(0,a.j4)(f,{ref:"loginForm",model:r.form,rules:r.rules,"label-width":"0",size:"large",onKeyup:(0,i.D2)(d.login,["enter"])},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{prop:"user"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:r.form.user,"onUpdate:modelValue":l[0]||(l[0]=e=>r.form.user=e),"prefix-icon":"el-icon-user",clearable:"",placeholder:e.$t("login.userPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),(0,a.Wm)(u,{prop:"password"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:r.form.password,"onUpdate:modelValue":l[1]||(l[1]=e=>r.form.password=e),"prefix-icon":"el-icon-lock",clearable:"","show-password":"",placeholder:e.$t("login.PWPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),(0,a.Wm)(u,{style:{"margin-bottom":"10px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{span:12},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{label:e.$t("login.rememberMe"),modelValue:r.form.autologin,"onUpdate:modelValue":l[2]||(l[2]=e=>r.form.autologin=e)},null,8,["label","modelValue"])])),_:1})])),_:1}),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{type:"primary",style:{width:"100%"},loading:r.islogin,round:"",onClick:d.login},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("login.signIn")),1)])),_:1},8,["loading","onClick"])])),_:1})])),_:1},8,["model","rules","onKeyup"])}var r={data(){return{userType:"admin",form:{user:"",password:"",autologin:!1},rules:{user:[{required:!0,message:this.$t("login.userError"),trigger:"blur"}],password:[{required:!0,message:this.$t("login.PWError"),trigger:"blur"}]},islogin:!1}},watch:{userType(e){"admin"==e?(this.form.user="admin",this.form.password="admin"):"user"==e&&(this.form.user="user",this.form.password="user")}},mounted(){},methods:{async login(){var e=await this.$refs.loginForm.validate().catch((()=>{}));if(!e)return!1;var l={username:this.form.user,password:this.form.password},t=await this.$API.auth.token.post(l);if(200!=t.code)return this.islogin=!1,this.$message.warning(t.message),!1;this.$TOOL.cookie.set("TOKEN",t.data.token,{expires:this.form.autologin?604800:0}),this.$TOOL.data.set("USER_INFO",t.data.userinfo),this.$TOOL.data.set("PERMISSIONS",t.data.permissions),this.$store.state.global.cash=t.data.userinfo.card_cash;let a=await this.$API.system.menu.menu.get();return 200!=a.code?(this.islogin=!1,this.$message.warning(a.message),!1):0==a.data.length?(this.islogin=!1,this.$alert("当前用户无任何菜单权限，请联系系统管理员","无权限访问",{type:"error",center:!0}),!1):(this.$TOOL.data.set("MENU",a.data),this.$router.replace({path:"/"}),this.$message.success("Login Success 登录成功"),void(this.islogin=!1))}}},d=t(3744);const n=(0,d.Z)(r,[["render",s]]);var u=n},6926:function(e,l,t){t.r(l),t.d(l,{default:function(){return p}});var a=t(6252),i=t(9963),o=t(3577);const s={class:"login-msg-yzm"},r={key:0},d={class:"login-reg"};function n(e,l,t,n,u,m){const c=(0,a.up)("el-input"),p=(0,a.up)("el-form-item"),f=(0,a.up)("el-button"),h=(0,a.up)("router-link"),b=(0,a.up)("el-form");return(0,a.wg)(),(0,a.j4)(b,{ref:"loginForm",model:u.form,rules:u.rules,"label-width":"0",size:"large",onKeyup:(0,i.D2)(m.login,["enter"])},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{prop:"phone"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:u.form.phone,"onUpdate:modelValue":l[0]||(l[0]=e=>u.form.phone=e),"prefix-icon":"el-icon-iphone",clearable:"",placeholder:e.$t("login.mobilePlaceholder")},{prepend:(0,a.w5)((()=>[(0,a.Uk)("+86")])),_:1},8,["modelValue","placeholder"])])),_:1}),(0,a.Wm)(p,{prop:"yzm",style:{"margin-bottom":"35px"}},{default:(0,a.w5)((()=>[(0,a._)("div",s,[(0,a.Wm)(c,{modelValue:u.form.yzm,"onUpdate:modelValue":l[1]||(l[1]=e=>u.form.yzm=e),"prefix-icon":"el-icon-unlock",clearable:"",placeholder:e.$t("login.smsPlaceholder")},null,8,["modelValue","placeholder"]),(0,a.Wm)(f,{onClick:m.getYzm,disabled:u.disabled},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(this.$t("login.smsGet")),1),u.disabled?((0,a.wg)(),(0,a.iD)("span",r," ("+(0,o.zw)(u.time)+")",1)):(0,a.kq)("",!0)])),_:1},8,["onClick","disabled"])])])),_:1}),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{type:"primary",style:{width:"100%"},loading:u.islogin,round:"",onClick:m.login},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("login.signIn")),1)])),_:1},8,["loading","onClick"])])),_:1}),(0,a._)("div",d,[(0,a.Uk)((0,o.zw)(e.$t("login.noAccount"))+" ",1),(0,a.Wm)(h,{to:"/user_register"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("login.createAccount")),1)])),_:1})])])),_:1},8,["model","rules","onKeyup"])}var u={data(){return{form:{phone:"",yzm:""},rules:{phone:[{required:!0,message:this.$t("login.mobileError")}],yzm:[{required:!0,message:this.$t("login.smsError")}]},disabled:!1,time:0,islogin:!1}},mounted(){},methods:{async getYzm(){var e=await this.$refs.loginForm.validateField("phone").catch((()=>{}));if(!e)return!1;this.$message.success(this.$t("login.smsSent")),this.disabled=!0,this.time=60;var l=setInterval((()=>{this.time-=1,this.time<1&&(clearInterval(l),this.disabled=!1,this.time=0)}),1e3)},async login(){var e=await this.$refs.loginForm.validate().catch((()=>{}));if(!e)return!1}}},m=t(3744);const c=(0,m.Z)(u,[["render",n]]);var p=c},1553:function(e,l,t){t.r(l),t.d(l,{default:function(){return b}});var a=t(6252),i=t(3577);const o={class:"left-panel"},s={class:"right-panel"},r={class:"right-panel-search"};function d(e,l,t,d,n,u){const m=(0,a.up)("el-button"),c=(0,a.up)("el-input"),p=(0,a.up)("el-header"),f=(0,a.up)("el-table-column"),h=(0,a.up)("el-icon-circle-check-filled"),b=(0,a.up)("el-icon"),g=(0,a.up)("el-icon-circle-close-filled"),w=(0,a.up)("el-popconfirm"),v=(0,a.up)("el-button-group"),_=(0,a.up)("scTable"),y=(0,a.up)("el-main"),V=(0,a.up)("el-container"),k=(0,a.up)("save-dialog"),W=(0,a.up)("importDialog"),$=(0,a.up)("drawerLog"),x=(0,a.up)("el-drawer");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(V,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",o,[e.$AUTH("params.bidding.edit")?((0,a.wg)(),(0,a.j4)(m,{key:0,type:"primary",icon:"el-icon-plus",onClick:u.add},null,8,["onClick"])):(0,a.kq)("",!0),e.$AUTH("params.bidding.import")?((0,a.wg)(),(0,a.j4)(m,{key:1,type:"primary",icon:"el-icon-upload",onClick:u.openImport},{default:(0,a.w5)((()=>[(0,a.Uk)("批量导入")])),_:1},8,["onClick"])):(0,a.kq)("",!0),e.$AUTH("params.bidding.export")?((0,a.wg)(),(0,a.j4)(m,{key:2,type:"primary",icon:"el-icon-download",onClick:u.openExport},{default:(0,a.w5)((()=>[(0,a.Uk)("导出")])),_:1},8,["onClick"])):(0,a.kq)("",!0)]),(0,a._)("div",s,[(0,a._)("div",r,[(0,a.Wm)(c,{modelValue:n.keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>n.keywords=e),placeholder:"参数名称或所属业务",clearable:""},null,8,["modelValue"]),(0,a.Wm)(m,{type:"primary",icon:"el-icon-search",onClick:u.upsearch},null,8,["onClick"])])])])),_:1}),(0,a.Wm)(y,{class:"nopadding"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{ref:"table",apiObj:n.apiObj,"row-key":"id",onSelectionChange:u.selectionChange,stripe:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"ID",prop:"id",width:"50"}),(0,a.Wm)(f,{label:"参数名称",prop:"name",width:"120"}),(0,a.Wm)(f,{label:"状态",prop:"enable",width:"80"},{default:(0,a.w5)((e=>[1==e.row.enable?((0,a.wg)(),(0,a.j4)(b,{key:0,style:{color:"#67c23a"}},{default:(0,a.w5)((()=>[(0,a.Wm)(h)])),_:1})):((0,a.wg)(),(0,a.j4)(b,{key:1,style:{color:"#f56c6c"}},{default:(0,a.w5)((()=>[(0,a.Wm)(g)])),_:1}))])),_:1}),(0,a.Wm)(f,{label:"学校",prop:"school",width:"80"},{default:(0,a.w5)((e=>[(0,a.Uk)((0,i.zw)(e.row.params.school),1)])),_:1}),(0,a.Wm)(f,{label:"说明",prop:"describe",width:"200"},{default:(0,a.w5)((e=>[(0,a.Uk)((0,i.zw)(e.row.params.describe),1)])),_:1}),(0,a.Wm)(f,{label:"修改记录",prop:"history",width:"150"},{default:(0,a.w5)((e=>[(0,a.Wm)(m,{type:"primary",link:"",onClick:l=>u.showHistory(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("查看")])),_:2},1032,["onClick"])])),_:1}),(0,a.Wm)(f,{label:"创建时间",prop:"creat_time",width:"150"}),(0,a.Wm)(f,{label:"操作",fixed:"right",align:"right",width:"120"},{default:(0,a.w5)((e=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{text:"",type:"primary",size:"small",onClick:l=>u.table_edit(e.row,e.$index)},{default:(0,a.w5)((()=>[(0,a.Uk)("编辑")])),_:2},1032,["onClick"]),(0,a.Wm)(w,{title:"确定删除吗？",onConfirm:l=>u.table_del(e.row,e.$index)},{reference:(0,a.w5)((()=>[(0,a.Wm)(m,{text:"",type:"primary",size:"small"},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})])),_:1},8,["apiObj","onSelectionChange"])])),_:1})])),_:1}),n.dialog.save?((0,a.wg)(),(0,a.j4)(k,{key:0,data:e.$refs.table.tableData,ref:"saveDialog",onSuccess:u.handleSuccess,onClosed:l[1]||(l[1]=e=>n.dialog.save=!1)},null,8,["data","onSuccess"])):(0,a.kq)("",!0),(0,a.Wm)(W,{modname:"文件编排",apiObj:n.uploadObj,ref:"importDialog",onSuccess:u.handleSuccess},null,8,["apiObj","onSuccess"]),(0,a.Wm)(x,{modelValue:n.dialog.log,"onUpdate:modelValue":l[2]||(l[2]=e=>n.dialog.log=e),size:"80%",title:"查看日志","destroy-on-close":""},{default:(0,a.w5)((()=>[(0,a.Wm)($,{ref:"drawerLog"},null,512)])),_:1},8,["modelValue"])],64)}var n=t(8109),u=t(616),m=t(8564),c=t(8204),p={name:"business",components:{saveDialog:u["default"],drawerLog:c["default"],importDialog:m["default"]},data(){return{dialog:{save:!1,log:!1},keywords:"",apiObj:this.$API.params.bidding.list,uploadObj:this.$API.params.bidding.import,selection:[],file:""}},methods:{add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open()}))},table_edit(e,l){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("edit").setData(e,l)}))},async table_del(e,l){var t={id:e.id};try{await this.$API.params.business.del.post(t),this.$refs.table.tableData.splice(l,1),this.$message.success("删除成功")}catch(a){}},async batch_del(){this.$confirm(`确定删除选中的 ${this.selection.length} 项吗？`,"提示",{type:"warning"}).then((()=>{const e=this.$loading();this.selection.forEach((e=>{this.$refs.table.tableData.forEach(((l,t)=>{e.id===l.id&&this.$refs.table.tableData.splice(t,1)}))})),e.close(),this.$message.success("操作成功")})).catch((()=>{}))},upsearch(){""==this.keywords?this.$refs.table.reload():this.$refs.table.reload({keywords:this.keywords})},openLog(){this.dialog.log=!0,this.$nextTick((()=>{let e={remark:""};this.$refs.drawerLog.setForm(e)}))},openImport(){this.$refs.importDialog.open()},openExport(){(0,n.G)(this.$refs.table.tableData,"文件编排导出")},selectionChange(e){this.selection=e},async showHistory(e){this.dialog.log=!0,this.$nextTick((()=>{let l={name:"文件编排增改",remark:String(e.id)};this.$refs.drawerLog.setForm(l)}))},handleSuccess(){this.$refs.table.getData()}}},f=t(3744);const h=(0,f.Z)(p,[["render",d]]);var b=h},616:function(e,l,t){t.r(l),t.d(l,{default:function(){return d}});var a=t(6252);function i(e,l,t,i,o,s){const r=(0,a.up)("el-input"),d=(0,a.up)("el-form-item"),n=(0,a.up)("el-switch"),u=(0,a.up)("el-form"),m=(0,a.up)("el-button"),c=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(c,{title:o.titleMap[o.mode],modelValue:o.visible,"onUpdate:modelValue":l[8]||(l[8]=e=>o.visible=e),width:500,"destroy-on-close":"",onClosed:l[9]||(l[9]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(m,{onClick:l[6]||(l[6]=e=>o.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(m,{type:"primary",loading:o.isSaveing,onClick:l[7]||(l[7]=e=>s.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])])),default:(0,a.w5)((()=>[(0,a.Wm)(u,{model:o.form,rules:o.rules,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.name,"onUpdate:modelValue":l[0]||(l[0]=e=>o.form.name=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"描述",prop:"describe"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.describe,"onUpdate:modelValue":l[1]||(l[1]=e=>o.form.describe=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"特别注意",prop:"attention"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.attention,"onUpdate:modelValue":l[2]||(l[2]=e=>o.form.attention=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),1==o.form.attention?((0,a.wg)(),(0,a.j4)(d,{key:0,label:"注意点",prop:"notice"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.notice,"onUpdate:modelValue":l[3]||(l[3]=e=>o.form.notice=e),clearable:""},null,8,["modelValue"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(d,{label:"所属业务",prop:"superior"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.superior,"onUpdate:modelValue":l[4]||(l[4]=e=>o.form.superior=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"是否启用",prop:"enable"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.enable,"onUpdate:modelValue":l[5]||(l[5]=e=>o.form.enable=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var o={props:["data"],emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增参数",edit:"编辑参数"},form:{name:"",describe:"",superior:"",enable:1,attention:0,notice:""},rules:{name:[{required:!0,message:"请输入名称"}],describe:[{required:!0,message:"请输入描述"}],superior:[{required:!0,message:"请输入所属业务",trigger:"change"}]},index:0,visible:!1,isSaveing:!1}},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;try{await this.$API.params.business.updata.post(this.form),this.visible=!1,this.$emit("success"),this.$message.success("操作成功")}catch(l){}finally{this.isSaveing=!1}}}))},setData(e,l){this.index=l,this.form=this.$TOOL.objCopy(e)},selectParms(e,l){for(let t of this.data)if(t.id==e){this.form.conflict[l]["superior"]=t.superior,this.form.conflict[l]["name"]=t.name;break}}}},s=t(3744);const r=(0,s.Z)(o,[["render",i]]);var d=r},7786:function(e,l,t){t.r(l),t.d(l,{default:function(){return n}});var a=t(6252);function i(e,l,t,i,o,s){const r=(0,a.up)("selectRow");return(0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.data,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{class:"border",key:e.name},[(0,a.Wm)(r,{name:e.name,data:e,target:t.target[e.name],onRowAdd:s.rowAdd,onRowDel:s.rowDel,onMove:s.move,index:l},null,8,["name","data","target","onRowAdd","onRowDel","onMove","index"]),void 0!=e.childrens&&0!=e.childrens.length?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(e.childrens,((l,i)=>((0,a.wg)(),(0,a.j4)(r,{key:l.name,name:e.name+"##"+l.name,data:l,index:i,target:t.target[e.name][l.name],onRowDel:s.rowDel,onMove:s.move},null,8,["name","data","index","target","onRowDel","onMove"])))),128)):(0,a.kq)("",!0)])))),128)}t(7658);var o=t(8422),s={name:"selectContent",props:["modelValue","target"],emits:["toprowdel"],data(){return{}},components:{selectRow:o["default"]},computed:{data:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},watch:{},mounted(){},methods:{rowAdd(e,l){let t=null;for(let a in this.data)if(this.data[a].name==e){t=this.data[a]["childrens"];break}t.length=0;for(let a of l)t.push(this.target[e][a]);this.addVisible=!1},rowDel(e,l){let t=e.split("##");if(1==t.length)this.data.splice(l,1);else if(2==t.length)for(let a in this.data)if(this.data[a]["name"]==t[0]){this.data[a]["childrens"].splice(l,1);break}},move(e,l,t){let a=e.split("##");if(1!=a.length){for(let i in this.data)if(this.data[i]["name"]==a[0]){let e=l+t,a=this.data[i]["childrens"];if(e<0||e>=a.length)return void console.log("边界,无法调整位置");let o=a.splice(l,1);return void a.splice(e,0,o[0])}}else{let e=l+t;if(e<0||e>=this.data.length)return void console.log("边界,无法调整位置");let a=this.data.splice(l,1);this.data.splice(e,0,a[0])}}}},r=t(3744);const d=(0,r.Z)(s,[["render",i]]);var n=d},8422:function(e,l,t){t.r(l),t.d(l,{default:function(){return w}});var a=t(6252),i=t(3577);const o={class:"flex-c"},s=(0,a._)("div",null,null,-1),r={class:"flex-ic px-4 col-span-2"},d={class:"w-full truncate"},n={class:"flex-ic items-center px-4 col-span-8"},u={class:"w-full truncate"},m={class:"flex-c"},c=(0,a._)("div",null,null,-1);function p(e,l,t,p,f,h){const b=(0,a.up)("el-button"),g=(0,a.up)("selectTable"),w=(0,a.up)("el-popover"),v=(0,a.up)("el-popconfirm");return(0,a.wg)(),(0,a.iD)("ul",{class:(0,i.C_)(["grid grid-cols-12 h-14 hover:bg-gray-100 truncate",t.data.id?"bg-gray-50":""])},[(0,a._)("li",o,[(0,a.Wm)(b,{class:"m-0",link:"",type:"primary",size:"small",icon:"el-icon-arrow-up-bold",onClick:l[0]||(l[0]=e=>h.move(-1))}),s,(0,a.Wm)(b,{class:"m-0",link:"",type:"success",size:"small",icon:"el-icon-arrow-down-bold",onClick:l[1]||(l[1]=e=>h.move(1))})]),(0,a._)("li",r,[(0,a._)("div",d,(0,i.zw)(-1==t.name.indexOf("##")?t.name:t.name.split("##")[1]),1)]),(0,a._)("li",n,[(0,a._)("div",u,(0,i.zw)(t.data.describe),1)]),(0,a._)("li",m,[t.data.id?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(w,{key:0,visible:f.addVisible,placement:"bottom",title:"新增参数",width:500,trigger:"click"},{reference:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"m-0",type:"primary",size:"small",link:"",onClick:l[4]||(l[4]=e=>f.addVisible=!0)},{default:(0,a.w5)((()=>[(0,a.Uk)("新增")])),_:1})])),default:(0,a.w5)((()=>[(0,a.Wm)(g,{modelValue:f.checkTempList,"onUpdate:modelValue":l[2]||(l[2]=e=>f.checkTempList=e),selected:t.data.childrens,data:t.target},null,8,["modelValue","selected","data"]),(0,a.Wm)(b,{class:"m-4",type:"primary",size:"small",onClick:h.rowAdd},{default:(0,a.w5)((()=>[(0,a.Uk)("确认")])),_:1},8,["onClick"]),(0,a.Wm)(b,{class:"m-4",size:"small",onClick:l[3]||(l[3]=e=>f.addVisible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("关闭")])),_:1})])),_:1},8,["visible"])),c,(0,a.Wm)(v,{title:"确定删除吗？",onConfirm:h.del},{reference:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"m-0",type:"danger",size:"small",plain:"",link:""},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:1})])),_:1},8,["onConfirm"]),f.addVisible?((0,a.wg)(),(0,a.iD)("div",{key:1,class:"w-screen h-screen fixed inset-0",onClick:l[5]||(l[5]=e=>h.away())})):(0,a.kq)("",!0)])],2)}var f=t(8968),h={name:"selectRow",props:{name:{type:String,default:""},data:{type:Object,default:()=>{}},target:{type:Object,default:()=>{}},index:{type:Number,default:0}},data(){return{checkTempList:[],addVisible:!1}},components:{selectTable:f["default"]},mounted(){},methods:{rowAdd(){this.$emit("rowAdd",this.name,this.checkTempList),this.addVisible=!1},del(){this.$emit("rowDel",this.name,this.index)},handleCommand(e){console.log(e)},move(e){console.log(e),this.$emit("move",this.name,this.index,e)},away(){this.addVisible=!1}}},b=t(3744);const g=(0,b.Z)(h,[["render",p]]);var w=g},8968:function(e,l,t){t.r(l),t.d(l,{default:function(){return _}});var a=t(6252),i=t(3577);const o={class:"text-[12px] text-gray-500"},s={class:"grid grid-cols-12 h-14"},r={class:"flex-c border"},d=(0,a._)("li",{class:"flex-c border col-span-3 font-bold"},"参数名称",-1),n=(0,a._)("li",{class:"flex-c border col-span-8 font-bold"},"下属参数",-1),u={class:"flex-c"},m={class:"flex-ic px-4 col-span-3 truncate"},c={class:"w-full"},p={class:"flex-ic px-4 col-span-8 truncate"},f={key:0,class:"w-full"},h={key:1,class:"w-full"};function b(e,l,t,b,g,w){const v=(0,a.up)("el-checkbox"),_=(0,a.up)("el-checkbox-group");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("ul",s,[(0,a._)("li",r,[(0,a.Wm)(v,{class:"st-checkbox",modelValue:g.select_all,"onUpdate:modelValue":l[0]||(l[0]=e=>g.select_all=e),label:"select_all",size:"small",onChange:w.selectAll},null,8,["modelValue","onChange"])]),d,n]),(0,a.Wm)(_,{modelValue:g.defaultValue,"onUpdate:modelValue":l[1]||(l[1]=e=>g.defaultValue=e),size:"small",onChange:w.change},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.data,((e,l)=>((0,a.wg)(),(0,a.iD)("ul",{class:"grid grid-cols-12 text-[12px] h-14 border hover:bg-gray-100",key:l},[(0,a._)("li",u,[(0,a.Wm)(v,{class:"st-checkbox",label:l,size:"small",onChange:l=>w.checkbox_change(l,e)},{default:(0,a.w5)((()=>[])),_:2},1032,["label","onChange"])]),(0,a._)("li",m,[(0,a._)("div",c,(0,i.zw)(l),1)]),(0,a._)("li",p,[(0,a._)("div",null,(0,i.zw)(e.describe),1),void 0!=e.id?((0,a.wg)(),(0,a.iD)("div",f,(0,i.zw)(e.describe),1)):((0,a.wg)(),(0,a.iD)("div",h,(0,i.zw)(Object.keys(e).join(",")),1))])])))),128))])),_:1},8,["modelValue","onChange"])])}t(7658);var g={props:{modelValue:null,data:{type:Object,default:()=>{}},selected:{type:Array,default:()=>[]}},data(){return{select_all:!1,defaultValue:[]}},computed:{},watch:{modelValue:{handler(){this.defaultValue=this.modelValue,this.autoCurrentLabel()},deep:!0},selected:{handler(){this.defaultValue.length=0;for(let e of this.selected)this.defaultValue.push(e["name"]);this.$emit("update:modelValue",this.defaultValue)},deep:!0}},mounted(){this.defaultValue=this.modelValue,this.autoCurrentLabel()},methods:{autoCurrentLabel(){},selectAll(){if(this.select_all)for(let e in this.data)e in this.defaultValue||(this.defaultValue.push(e),this.checkbox_change(!0,this.data[e],!1));else this.defaultValue.length=0;this.$emit("update:modelValue",this.defaultValue)},checkbox_change(e,l,t=!0){if(Reflect.has(l,"conflict")){if(e){let e=[];for(let a in this.defaultValue){let i=this.defaultValue[a],o=!0;for(let e of l.conflict)if(i==e.name){o=!o;break}o?e.push(i):t&&this.$message.warning(`当前选择的 【${l.name}】 参数与 【${i}】 冲突,已取消冲突参数的勾选`)}this.defaultValue=e,this.$emit("update:modelValue",this.defaultValue)}}else;},change(){0==this.defaultValue.length?this.select_all=!1:this.defaultValue.length==Object.keys(this.data).length&&(this.select_all=!0),this.$emit("update:modelValue",this.defaultValue)}}},w=t(3744);const v=(0,w.Z)(g,[["render",b]]);var _=v},3905:function(e,l,t){t.r(l),t.d(l,{default:function(){return b}});var a=t(6252),i=t(3577);const o={class:"sc-form-table",ref:"formTable"},s={class:"sc-table-select__table"},r={class:"sc-table-select__page"},d={class:"sc-form-table-handle"},n={class:"move",style:{cursor:"move"}};function u(e,l,t,u,m,c){const p=(0,a.up)("el-table-column"),f=(0,a.up)("el-table"),h=(0,a.up)("el-pagination"),b=(0,a.up)("el-icon-plus"),g=(0,a.up)("el-icon"),w=(0,a.up)("el-button"),v=(0,a.up)("el-popover"),_=(0,a.up)("el-popconfirm"),y=(0,a.up)("el-icon-d-caret"),V=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(f,{data:m.defaultValue,ref:"table",border:"",stripe:""},{empty:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.placeholder),1)])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{type:"index",width:"50",fixed:"left"},(0,a.Nv)({default:(0,a.w5)((e=>[(0,a._)("div",d,[(0,a._)("span",null,(0,i.zw)(e.$index+1),1),(0,a.Wm)(_,{title:"确定删除吗？",onConfirm:l=>c.rowDel(e.row,e.$index)},{reference:(0,a.w5)((()=>[(0,a.Wm)(w,{type:"danger",icon:"el-icon-delete",size:"small",plain:"",circle:""})])),_:2},1032,["onConfirm"])])])),_:2},[t.addEnble?{name:"header",fn:(0,a.w5)((()=>[(0,a.Wm)(v,{placement:"bottom",title:"新增参数",width:500,trigger:"click"},{reference:(0,a.w5)((()=>[(0,a.Wm)(w,{type:"primary",size:"small",circle:"",onClick:l[1]||(l[1]=e=>m.addVisible=!0)},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b)])),_:1})])),_:1})])),default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(f,{ref:"selectTable",data:m.tableData,height:245,"highlight-current-row":!t.multiple,onSelect:c.select,onSelectAll:c.selectAll},{default:(0,a.w5)((()=>[t.multiple?((0,a.wg)(),(0,a.j4)(p,{key:0,type:"selection",width:"45"})):((0,a.wg)(),(0,a.j4)(p,{key:1,type:"index",width:"45"},{default:(0,a.w5)((e=>[(0,a._)("span",null,(0,i.zw)(e.$index+(m.currentPage-1)*m.pageSize+1),1)])),_:1})),(0,a.WI)(e.$slots,"default",{},void 0,!0)])),_:3},8,["data","highlight-current-row","onSelect","onSelectAll"]),(0,a._)("div",r,[(0,a.Wm)(h,{small:"",background:"",layout:"prev, pager, next",total:m.total,"page-size":m.pageSize,currentPage:m.currentPage,"onUpdate:currentPage":l[0]||(l[0]=e=>m.currentPage=e),onCurrentChange:c.reload},null,8,["total","page-size","currentPage","onCurrentChange"])])])),[[V,m.loading]])])),_:3})])),key:"0"}:void 0]),1024),t.dragSort?((0,a.wg)(),(0,a.j4)(p,{key:0,label:"",width:"50"},{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a.Wm)(y,{style:{width:"1em",height:"1em"}})])])),_:1})):(0,a.kq)("",!0),(0,a.WI)(e.$slots,"default",{},void 0,!0)])),_:3},8,["data"])],512)}t(7658);var m=t(4457),c=t(1474),p={props:{modelValue:null,apiObj:{type:Object,default:()=>{}},params:{type:Object,default:()=>{}},placeholder:{type:String,default:"暂无数据"},multiple:{type:Boolean,default:!1},props:{type:Object,default:()=>{}},addEnble:{type:Boolean,default:!0},dragSort:{type:Boolean,default:!0}},data(){return{addTemplate:{time:"",type:"",val:"",open:!0,checked:!1},loading:!1,keyword:null,defaultValue:[],tableData:[],pageSize:m.Z.pageSize,total:0,currentPage:1,defaultProps:{label:m.Z.props.label,value:m.Z.props.value,page:m.Z.request.page,pageSize:m.Z.request.pageSize,keyword:m.Z.request.keyword},addVisible:!1,formData:{},checkValue:[]}},computed:{},watch:{modelValue(){this.defaultValue=this.modelValue}},mounted(){this.defaultProps=Object.assign(this.defaultProps,this.props),this.defaultValue=this.modelValue,this.getData(),this.dragSort&&this.rowDrop()},methods:{rowDrop(){const e=this,l=this.$refs.table.$el.querySelector(".el-table__body-wrapper tbody");c.ZP.create(l,{handle:".move",animation:300,ghostClass:"ghost",onEnd({newIndex:l,oldIndex:t}){e.defaultValue.splice(l,0,e.defaultValue.splice(t,1)[0]);const a=e.defaultValue.slice(0),i=e.$refs.formTable.offsetHeight;e.$refs.formTable.style.setProperty("height",i+"px"),e.defaultValue=[],e.$nextTick((()=>{e.defaultValue=a,e.$nextTick((()=>{e.$refs.formTable.style.removeProperty("height")}))}))}})},rowDel(e,l){this.defaultValue.splice(l,1),this.$refs.selectTable.toggleRowSelection(e,void 0)},async getData(){this.loading=!0;var e={[this.defaultProps.page]:this.currentPage,[this.defaultProps.pageSize]:this.pageSize,[this.defaultProps.keyword]:this.keyword};Object.assign(e,this.params,this.formData);try{var l=await this.apiObj.get(e)}catch(a){}finally{this.loading=!1}var t=m.Z.parseData(l);this.tableData=t.rows,this.total=t.total,this.$nextTick((()=>{if(this.multiple)this.defaultValue.forEach((e=>{var l=this.tableData.filter((l=>l[this.defaultProps.value]===e[this.defaultProps.value]));l.length>0&&this.$refs.table.toggleRowSelection(l[0],!0)}));else{var e=this.tableData.filter((e=>e[this.defaultProps.value]===this.defaultValue[this.defaultProps.value]));this.$refs.table.setCurrentRow(e[0])}this.$refs.table.setScrollTop(0)}))},reload(){this.getData()},select(e,l){var t=e.length&&-1!==e.indexOf(l);t?this.defaultValue.push(l):this.defaultValue.splice(this.defaultValue.findIndex((e=>e[this.defaultProps.value]==l[this.defaultProps.value])),1),this.$emit("update:modelValue",this.defaultValue),this.$emit("change",this.defaultValue)},selectAll(e){var l=e.length>0;l?e.forEach((e=>{var l=this.defaultValue.find((l=>l[this.defaultProps.value]==e[this.defaultProps.value]));l||this.defaultValue.push(e)})):this.tableData.forEach((e=>{var l=this.defaultValue.find((l=>l[this.defaultProps.value]==e[this.defaultProps.value]));l&&this.defaultValue.splice(this.defaultValue.findIndex((l=>l[this.defaultProps.value]==e[this.defaultProps.value])),1)})),this.$emit("update:modelValue",this.defaultValue),this.$emit("change",this.defaultValue)}}},f=t(3744);const h=(0,f.Z)(p,[["render",u],["__scopeId","data-v-5e1168da"]]);var b=h},5661:function(e,l,t){t.r(l),t.d(l,{default:function(){return k}});var a=t(6252);const i={key:0,class:"px-20 m-40"},o={key:1,class:"px-10 mx-10 my-10"},s={key:2,class:"px-10 mx-20"},r={key:3,class:"px-10 mx-10 my-10"},d={key:4,class:"px-10 mx-10 my-10"},n={key:5,class:"px-10 mx-10 my-10"},u={key:6,class:"px-10 mx-10 my-10"},m={class:"flex-c"};function c(e,l,t,c,p,f){const h=(0,a.up)("el-step"),b=(0,a.up)("el-steps"),g=(0,a.up)("el-header"),w=(0,a.up)("s1Step"),v=(0,a.up)("s2Step"),_=(0,a.up)("s3Step"),y=(0,a.up)("s4Step"),V=(0,a.up)("s5Step"),k=(0,a.up)("s6Step"),W=(0,a.up)("s7Step"),$=(0,a.up)("el-main"),x=(0,a.up)("el-button"),U=(0,a.up)("el-footer"),C=(0,a.up)("el-container"),S=(0,a.Q2)("loading");return(0,a.wy)(((0,a.wg)(),(0,a.j4)(C,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"header-tabs"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{active:p.active,"align-center":""},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{title:"基础信息"}),(0,a.Wm)(h,{title:"框架技术要求"}),(0,a.Wm)(h,{title:"采购需求"}),(0,a.Wm)(h,{title:"功能技术要求"}),(0,a.Wm)(h,{title:"商务参数"}),(0,a.Wm)(h,{title:"评审(价格)参数"}),(0,a.Wm)(h,{title:"导出预览"})])),_:1},8,["active"])])),_:1}),(0,a.Wm)($,{class:"my-10"},{default:(0,a.w5)((()=>[1==p.active?((0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(w,{ref:"step1"},null,512)])):2==p.active?((0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(v,{ref:"step2"},null,512)])):3==p.active?((0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(_,{ref:"step3"},null,512)])):4==p.active?((0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(y,{ref:"step4"},null,512)])):5==p.active?((0,a.wg)(),(0,a.iD)("div",d,[(0,a.Wm)(V,{ref:"step5"},null,512)])):6==p.active?((0,a.wg)(),(0,a.iD)("div",n,[(0,a.Wm)(k,{ref:"step6"},null,512)])):7==p.active?((0,a.wg)(),(0,a.iD)("div",u,[(0,a.Wm)(W,{ref:"step7"},null,512)])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a._)("div",m,[(0,a.Wm)(x,{type:"primary",icon:"el-icon-refresh",onClick:f.refresh},{default:(0,a.w5)((()=>[(0,a.Uk)("重置")])),_:1},8,["onClick"]),p.active>1?((0,a.wg)(),(0,a.j4)(x,{key:0,type:"primary",onClick:f.lastStep},{default:(0,a.w5)((()=>[(0,a.Uk)("上一步")])),_:1},8,["onClick"])):(0,a.kq)("",!0),p.active<p.maxStep?((0,a.wg)(),(0,a.j4)(x,{key:1,type:"primary",onClick:f.nextStep},{default:(0,a.w5)((()=>[(0,a.Uk)("下一步")])),_:1},8,["onClick"])):(0,a.kq)("",!0),p.active==p.maxStep?((0,a.wg)(),(0,a.j4)(x,{key:2,loading:p.done_loading,type:"primary",onClick:f.sbumit},{default:(0,a.w5)((()=>[(0,a.Uk)("完成")])),_:1},8,["loading","onClick"])):(0,a.kq)("",!0),(0,a.Wm)(x,{type:"primary",onClick:f.test},{default:(0,a.w5)((()=>[(0,a.Uk)("测试")])),_:1},8,["onClick"])])])),_:1})])),_:1})),[[S,f.loading]])}var p=t(4603),f=t(2408),h=t(1740),b=t(2133),g=t(4413),w=t(7313),v=t(1529),_={props:[],emits:[],data(){return{active:7,maxStep:7,id:"",done_loading:!1}},computed:{loading:{set(e){this.$store.state.bidding.bidding_loading=e},get(){return this.$store.state.bidding.bidding_loading}},form(){return this.$store.state.bidding.bidding_form}},components:{s1Step:p["default"],s2Step:f["default"],s3Step:h["default"],s4Step:b["default"],s5Step:g["default"],s6Step:w["default"],s7Step:v["default"]},methods:{lastStep(){this.active-=1,this.$nextTick((()=>{let e=this.$refs["step"+this.active];e.back()}))},nextStep(){let e=this.$refs["step"+this.active];e.validate().then((()=>{this.$store.commit("updata_form",e.form),this.active+=1}))},async sbumit(){try{this.done_loading=!0;let e=await this.$API.params.bidding.generate.post(this.form);console.log(e)}catch{}this.done_loading=!1,console.log("完成",this.$refs)},refresh(){let e=this.$refs["step"+this.active];e.refresh()},test(){console.log(this.$store.state.bidding.bidding_form)},fetchData(){this.$store.dispatch("fetchTechnical")}},mounted(){this.fetchData()},beforeMount(){},created(){}},y=t(3744);const V=(0,y.Z)(_,[["render",c]]);var k=V},4603:function(e,l,t){t.r(l),t.d(l,{default:function(){return d}});var a=t(6252);function i(e,l,t,i,o,s){const r=(0,a.up)("el-input"),d=(0,a.up)("el-form-item"),n=(0,a.up)("el-form");return(0,a.wg)(),(0,a.j4)(n,{model:s.form,rules:o.rules,ref:"dataForm","label-width":"100px","label-position":"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"项目名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:s.form.name,"onUpdate:modelValue":l[0]||(l[0]=e=>s.form.name=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"项目描述",prop:"describe"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:s.form.describe,"onUpdate:modelValue":l[1]||(l[1]=e=>s.form.describe=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"学校",prop:"school"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:s.form.school,"onUpdate:modelValue":l[2]||(l[2]=e=>s.form.school=e),clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])}var o={props:[],emits:[],data(){return{rules:{name:[{required:!0,message:"请输入名称"}]}}},computed:{form(){return this.$store.state.bidding.bidding_form}},components:{},methods:{refresh(){let e={name:"",describe:"",school:""};this.$store.commit("updata_form",e)},back(){},validate(){return new Promise(((e,l)=>{this.$refs.dataForm.validate((async t=>{t?e():l()}))}))}},mounted(){},beforeMount(){},created(){}},s=t(3744);const r=(0,s.Z)(o,[["render",i]]);var d=r},2408:function(e,l,t){t.r(l),t.d(l,{default:function(){return g}});var a=t(6252);const i={class:"text-gray-600"},o={class:"grid grid-cols-12 h-14"},s={class:"flex-c border"},r=(0,a._)("li",{class:"flex-c border col-span-2 font-bold text-gray-500"},"参数名称",-1),d=(0,a._)("li",{class:"flex-c border col-span-8 font-bold text-gray-500"},"参数内容",-1),n=(0,a._)("li",{class:"flex-c border"}," 操作 ",-1);function u(e,l,t,u,m,c){const p=(0,a.up)("selectTable"),f=(0,a.up)("el-button"),h=(0,a.up)("el-popover"),b=(0,a.up)("selectContent");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("ul",o,[(0,a._)("li",s,[(0,a.Wm)(h,{visible:m.addVisible,placement:"bottom",title:"新增参数",width:500,trigger:"click"},{reference:(0,a.w5)((()=>[(0,a.Wm)(f,{type:"primary",icon:"el-icon-plus",size:"small",circle:"",onClick:l[2]||(l[2]=e=>m.addVisible=!0)})])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{modelValue:m.checkTempList,"onUpdate:modelValue":l[0]||(l[0]=e=>m.checkTempList=e),selected:c.tec_frame,data:c.target},null,8,["modelValue","selected","data"]),(0,a.Wm)(f,{class:"m-4",type:"primary",size:"small",onClick:c.rowAdd},{default:(0,a.w5)((()=>[(0,a.Uk)("确认")])),_:1},8,["onClick"]),(0,a.Wm)(f,{class:"m-4",size:"small",onClick:l[1]||(l[1]=e=>m.addVisible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("关闭")])),_:1})])),_:1},8,["visible"]),m.addVisible?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"w-screen h-screen fixed inset-0",onClick:l[3]||(l[3]=e=>c.away())})):(0,a.kq)("",!0)]),r,d,n]),(0,a.Wm)(b,{modelValue:c.tec_frame,"onUpdate:modelValue":l[4]||(l[4]=e=>c.tec_frame=e),target:c.target,onToprowdel:c.rowDel},null,8,["modelValue","target","onToprowdel"])])}t(7658);var m=t(8968),c=t(7786),p=t(9737),f={props:[],emits:[],data(){return{checkTempList:[],value:"",addVisible:!1}},computed:{form(){return this.$store.state.bidding.bidding_form},target(){return this.$store.state.bidding.technical["框架要求"]},tec_frame:{get(){return this.form.render.tec_frame},set(e){this.form.render.tec_frame=e}}},components:{selectTable:m["default"],selectContent:c["default"]},methods:{rowAdd(){let e=this.tec_frame,l=[];for(let t of this.checkTempList){let a=!0;for(let i of e)if(i.name==t){l.push(i),a=!1;break}a&&l.push({name:t,childrens:[]})}this.tec_frame=l,this.addVisible=!1},rowDel(e,l){let t=l.split("##");if(1==t.length){for(let e in this.checkTempList)if(this.checkTempList[e]==t[0]){this.checkTempList.splice(e,1);break}this.tec_frame.splice(e,1)}else if(2==t.length)for(let a in this.tec_frame)console.log(a),this.tec_frame[e]["childrens"].splice(e,1)},refresh(){this.tec_frame.length=0},away(){this.addVisible=!1},back(){},validate(){return new Promise(((e,l)=>{if(console.log("当前已编辑参数:",this.form),0==this.tec_frame.length)p.T.confirm("未选择任何参数,是否继续?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{l()}));else{let t="";for(let e of this.tec_frame)0==e.childrens.length&&(t+=`【${e.name}】 `);""==t?e():p.T.confirm(`参数${t}未选择子参数,是否继续`,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{l()}))}}))}},mounted(){},beforeMount(){},created(){}},h=t(3744);const b=(0,h.Z)(f,[["render",u]]);var g=b},1740:function(e,l,t){t.r(l),t.d(l,{default:function(){return n}});var a=t(6252);const i=(0,a._)("div",{class:"card-header"},[(0,a._)("span",null,"采购需求编辑")],-1);function o(e,l,t,o,s,r){const d=(0,a.up)("el-input"),n=(0,a.up)("el-card"),u=(0,a.up)("el-main"),m=(0,a.up)("el-container");return(0,a.wg)(),(0,a.j4)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"h-full"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{class:"h-full",shadow:"never"},{header:(0,a.w5)((()=>[i])),default:(0,a.w5)((()=>[(0,a.Wm)(d,{modelValue:r.form.purchase_docs,"onUpdate:modelValue":l[0]||(l[0]=e=>r.form.purchase_docs=e),type:"textarea",autosize:{minRows:5,maxRows:10}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})}var s={props:[],emits:[],data(){return{files:[],rules:{purchase_docs:[{required:!0,message:"请选择"}]},previewUrl:""}},computed:{form(){return this.$store.state.bidding.bidding_form}},components:{},methods:{async getFiles(){try{let e=await this.$API.common.file.docs.get();this.files=e.data.files}catch(e){}},loadPreview(){let e=this.form.purchase_docs.replace(/.docx$/,".png");this.previewUrl="/fileload?path=docs/preview&file="+e},imgerror(){this.previewUrl=""},refresh(){this.getFiles()},back(){},validate(){return new Promise((e=>{e()}))},handleSuccess(){}},mounted(){this.getFiles()},beforeMount(){},created(){}},r=t(3744);const d=(0,r.Z)(s,[["render",o]]);var n=d},2133:function(e,l,t){t.r(l),t.d(l,{default:function(){return g}});var a=t(6252);const i={class:"text-gray-600"},o={class:"grid grid-cols-12 h-14"},s={class:"flex-c border"},r=(0,a._)("li",{class:"flex-c border col-span-2 font-bold text-gray-500"},"参数名称",-1),d=(0,a._)("li",{class:"flex-c border col-span-8 font-bold text-gray-500"},"参数内容",-1),n=(0,a._)("li",{class:"flex-c border"}," 操作 ",-1);function u(e,l,t,u,m,c){const p=(0,a.up)("selectTable"),f=(0,a.up)("el-button"),h=(0,a.up)("el-popover"),b=(0,a.up)("selectContent");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("ul",o,[(0,a._)("li",s,[(0,a.Wm)(h,{visible:m.addVisible,placement:"bottom",title:"新增参数",width:500,trigger:"click"},{reference:(0,a.w5)((()=>[(0,a.Wm)(f,{type:"primary",icon:"el-icon-plus",size:"small",circle:"",onClick:l[2]||(l[2]=e=>m.addVisible=!0)})])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{modelValue:m.checkTempList,"onUpdate:modelValue":l[0]||(l[0]=e=>m.checkTempList=e),selected:c.tec_function,data:c.target},null,8,["modelValue","selected","data"]),(0,a.Wm)(f,{class:"m-4",type:"primary",size:"small",onClick:c.rowAdd},{default:(0,a.w5)((()=>[(0,a.Uk)("确认")])),_:1},8,["onClick"]),(0,a.Wm)(f,{class:"m-4",size:"small",onClick:l[1]||(l[1]=e=>m.addVisible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("关闭")])),_:1})])),_:1},8,["visible"]),m.addVisible?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"w-screen h-screen fixed inset-0",onClick:l[3]||(l[3]=e=>c.away())})):(0,a.kq)("",!0)]),r,d,n]),(0,a.Wm)(b,{modelValue:c.tec_function,"onUpdate:modelValue":l[4]||(l[4]=e=>c.tec_function=e),target:c.target,onToprowdel:c.rowDel},null,8,["modelValue","target","onToprowdel"])])}t(7658);var m=t(8968),c=t(7786),p=t(9737),f={props:[],emits:[],data(){return{checkTempList:[],value:"",addVisible:!1}},computed:{form(){return this.$store.state.bidding.bidding_form},target(){return this.$store.state.bidding.technical["功能要求"]},tec_function:{get(){return this.form.render.tec_function},set(e){this.form.render.tec_function=e}}},components:{selectTable:m["default"],selectContent:c["default"]},methods:{rowAdd(){let e=this.tec_function,l=[];for(let t of this.checkTempList){let a=!0;for(let i of e)if(i.name==t){l.push(i),a=!1;break}a&&l.push({name:t,childrens:[]})}this.tec_function=l,this.addVisible=!1},rowDel(e,l){let t=l.split("##");if(1==t.length){for(let e in this.checkTempList)if(this.checkTempList[e]==t[0]){this.checkTempList.splice(e,1);break}this.tec_function.splice(e,1)}else if(2==t.length)for(let a in this.tec_function)console.log(a),this.tec_function[e]["childrens"].splice(e,1)},refresh(){this.tec_function.length=0},away(){this.addVisible=!1},back(){},validate(){return this.addVisible=!1,new Promise(((e,l)=>{if(console.log("当前已编辑参数:",this.form),0==this.tec_function.length)p.T.confirm("未选择任何参数,是否继续?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{l()}));else{let t="";for(let e of this.tec_function)0==e.childrens.length&&(t+=`【${e.name}】 `);""==t?e():p.T.confirm(`参数${t}未选择子参数,是否继续`,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{l()}))}}))}},mounted(){},beforeMount(){},created(){}},h=t(3744);const b=(0,h.Z)(f,[["render",u]]);var g=b},4413:function(e,l,t){t.r(l),t.d(l,{default:function(){return m}});var a=t(6252);const i={class:"text-gray-600"};function o(e,l,t,o,s,r){const d=(0,a.up)("el-table-column"),n=(0,a.up)("selectTable");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(n,{modelValue:r.business,"onUpdate:modelValue":l[0]||(l[0]=e=>r.business=e),apiObj:s.apiObj,multiple:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",props:s.props,onChange:r.change},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{prop:"id",label:"ID",width:"50"}),(0,a.Wm)(d,{label:"参数名称",prop:"name",width:"150"}),(0,a.Wm)(d,{label:"参数内容",prop:"describe","show-overflow-tooltip":""})])),_:1},8,["modelValue","apiObj","props","onChange"])])}var s=t(3905),r=t(9737),d={props:[],emits:[],data(){return{checkTempList:[],value:[],target:[],apiObj:this.$API.params.business.list,props:{label:"name",value:"id"}}},computed:{form(){return this.$store.state.bidding.bidding_form},business:{get(){return this.form.render.business},set(e){this.form.render.business=e}}},components:{selectTable:s["default"]},methods:{change(){},refresh(){this.business.length=0},back(){},validate(){return new Promise(((e,l)=>{console.log("当前已编辑参数:",this.form),0==this.business.length?r.T.confirm("未选择任何参数,是否继续?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{l()})):e()}))}},mounted(){},beforeMount(){},created(){}},n=t(3744);const u=(0,n.Z)(d,[["render",o]]);var m=u},7313:function(e,l,t){t.r(l),t.d(l,{default:function(){return p}});var a=t(6252),i=t(3577);const o={class:"text-gray-600"},s={class:"flex flex-row-reverse m-2"};function r(e,l,t,r,d,n){const u=(0,a.up)("el-tag"),m=(0,a.up)("el-table-column"),c=(0,a.up)("el-input"),p=(0,a.up)("selectTable");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",s,[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Uk)("总分:"+(0,i.zw)(n.total_score),1)])),_:1})]),(0,a.Wm)(p,{modelValue:n.review,"onUpdate:modelValue":l[0]||(l[0]=e=>n.review=e),apiObj:d.apiObj,multiple:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",props:d.props,onChange:n.change},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{prop:"id",label:"ID",width:"50"}),(0,a.Wm)(m,{label:"参数名称",prop:"name",width:"150"}),(0,a.Wm)(m,{label:"参数内容",prop:"describe"}),(0,a.Wm)(m,{label:"分值",prop:"score",width:"75"},{default:(0,a.w5)((e=>[(0,a.Wm)(c,{modelValue:e.row.score,"onUpdate:modelValue":l=>e.row.score=l,placeholder:"请输入",formatter:e=>`${e}`,parser:e=>e.replace(/\D/g,""),size:"small"},null,8,["modelValue","onUpdate:modelValue","formatter","parser"])])),_:1})])),_:1},8,["modelValue","apiObj","props","onChange"])])}var d=t(3905),n=t(9737),u={props:[],emits:[],data(){return{checkTempList:[],value:[],target:[],apiObj:this.$API.params.review.list,props:{label:"name",value:"id"}}},computed:{form(){return this.$store.state.bidding.bidding_form},review:{get(){return this.form.render.review},set(e){this.form.render.review=e}},total_score(){let e=0;for(let l of this.review){let t=l["score"];t&&(e+=Number(t))}return e}},components:{selectTable:d["default"]},methods:{change(){},refresh(){this.review.length=0},back(){},validate(){return new Promise(((e,l)=>{if(console.log("当前已编辑参数:",this.form),0==this.review.length)n.T.confirm("未选择任何参数,是否继续?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{e()})).catch((()=>{l()}));else{for(let e in this.review){let t=this.review[e];if(!Reflect.has(t,"score")||""==t["score"])return void n.T.alert("请输入参数【"+t["name"]+"】的分数","提示",{confirmButtonText:"确认",type:"error"}).then((()=>{l()}))}e()}}))}},mounted(){},beforeMount(){},created(){}},m=t(3744);const c=(0,m.Z)(u,[["render",r]]);var p=c},1529:function(e,l,t){t.r(l),t.d(l,{default:function(){return S}});var a=t(6252),i=t(3577);const o={class:""},s=(0,a._)("div",{class:"text-2xl font-bold"},"选择word模板",-1),r=(0,a._)("div",{class:"flex-c my-4"},[(0,a._)("span",{class:"text-4xl font-bold"},"第一章. 采购需求")],-1),d={class:"my-4"},n=(0,a._)("span",{class:"text-2xl my-4 font-bold"},"一、项目技术（服务）要求：",-1),u={class:"my-4"},m=(0,a._)("span",{class:"text-xl font-bold"},"（一）框架类技术要求",-1),c={class:"text-xl font-bold"},p={class:"my-4"},f=(0,a._)("span",{class:"text-xl font-bold"},"（二）功能类技术要求",-1),h={class:"text-xl font-bold"},b={class:"my-4"},g=(0,a._)("span",{class:"text-xl font-bold"},"（三）商务需求",-1),w={class:"text-xl font-bold"},v={class:""},_=(0,a._)("div",{class:"flex-c my-4"},[(0,a._)("span",{class:"text-4xl font-bold"},"第二章. 评审标准")],-1),y={class:"my-4"},V={class:"text-xl font-bold flex justify-between"},k=(0,a._)("div",{class:"h-full mx-4 flex-grow flex-c"},[(0,a._)("div",{class:"w-full bg-gray-100",style:{height:"0.5px"}}),(0,a.Uk)("   ")],-1),W={class:""};function $(e,l,t,$,x,U){const C=(0,a.up)("el-alert"),S=(0,a.up)("el-card");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(C,{title:"提示:本页面仅展示数据,具体样式以word模板为准",type:"warning"}),(0,a.Wm)(S,{class:"w-full mt-4",shadow:"never"},{default:(0,a.w5)((()=>[s])),_:1}),(0,a.Wm)(S,{class:"w-full mt-4",shadow:"never"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[r,(0,a._)("div",d,[n,(0,a._)("div",u,[m,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(x.form.render.tec_frame,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{class:"my-8",key:l},[(0,a._)("div",c,(0,i.zw)(l+1)+". "+(0,i.zw)(e["name"]),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e["childrens"],((e,l)=>((0,a.wg)(),(0,a.iD)("div",{key:e},(0,i.zw)(l+1)+". "+(0,i.zw)(e["describe"]),1)))),128))])))),128))]),(0,a._)("div",p,[f,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(x.form.render.tec_frame,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{class:"my-8",key:l},[(0,a._)("div",h,(0,i.zw)(l+1)+". "+(0,i.zw)(e["name"]),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e["childrens"],((e,l)=>((0,a.wg)(),(0,a.iD)("div",{key:e},(0,i.zw)(l+1)+". "+(0,i.zw)(e["describe"]),1)))),128))])))),128))]),(0,a._)("div",b,[g,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(x.form.render.business,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{class:"my-8",key:l},[(0,a._)("div",w,(0,i.zw)(l+1)+". "+(0,i.zw)(e["name"]),1),(0,a._)("div",v,(0,i.zw)(e["describe"]),1)])))),128))])])]),(0,a._)("div",null,[_,(0,a._)("div",y,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(x.form.render.review,((e,l)=>((0,a.wg)(),(0,a.iD)("div",{class:"my-8",key:l},[(0,a._)("div",V,[(0,a._)("div",null,(0,i.zw)(l+1)+". "+(0,i.zw)(e["name"]),1),k,(0,a._)("div",null,(0,i.zw)(e["score"])+"分",1)]),(0,a._)("div",W,(0,i.zw)(e["describe"]),1)])))),128))])])])),_:1})])}var x={props:[],emits:[],computed:{},data(){return{form:{name:"测试111",describe:"",school:"",purchase_docs:"XXXX学院/大学成人教育信息化平台是搭建在统一数据库及云服务支撑环境的基础上，开发建设统一身份认证系统、门户网站，以及以综合管理平台为后台总支撑的从招生、学籍管理平台、教学教务、考务、督导、财务、论文、毕业、学位、学习平台、移动端APP等，能满足学院成人教育的管理和教学的信息化。能针对采购人业务特点和要求免费提供平台或系统的个性化定制、二次开发“量身打造”等服务。",template:"医学类评标参数",render:{tec_frame:[{name:"测试222",childrens:[{id:40,name:"框架要求导入测试参数111",describe:"导入测试参数描述1",level:1.5,superior:"导入测试参数所属业务1",enable:1,demonstrate:1,conflict:[],history:null,layer:"框架要求||测试222",creat_time:"2023-04-07 05:27:25"},{id:41,name:"框架要求导入测试参数33",describe:"导入测试参数描述3",level:3.5,superior:"导入测试参数所属业务3",enable:1,demonstrate:0,conflict:[],history:null,layer:"框架要求||测试222",creat_time:"2023-04-07 05:27:25"}]},{name:"测试322",childrens:[{id:42,name:"框架要求导入测试参数44",describe:"导入测试参数描述4",level:4.5,superior:"导入测试参数所属业务4",enable:1,demonstrate:0,conflict:[],history:null,layer:"框架要求||测试322",creat_time:"2023-04-07 05:27:25"}]},{name:"测试333",childrens:[{id:43,name:"框架要求导入测试参数55",describe:"导入测试参数描述5",level:4.5,superior:"导入测试参数所属业务5",enable:1,demonstrate:0,conflict:[],history:null,layer:"框架要求||测试333",creat_time:"2023-04-07 05:27:25"}]}],tec_function:[{name:"123",childrens:[{id:39,name:"123",describe:"123",level:1.5,superior:"123",enable:1,demonstrate:0,conflict:[],history:"",layer:"功能要求||123",creat_time:"2023-04-06 08:06:18"}]},{name:"开发语言及框架",childrens:[{id:5,name:"测试参数222",describe:"测试参数描述222",level:1.5,superior:"测试参数所属业务222",enable:1,demonstrate:1,conflict:[{id:1,name:"测试1",superior:"测试业务111"}],history:"",layer:"功能要求||开发语言及框架",creat_time:"2023-03-01 06:12:01"},{id:22,name:"修改测试",describe:"修改测试",level:1.5,superior:"修改测试",enable:1,demonstrate:0,conflict:[],history:"",layer:"功能要求||开发语言及框架",creat_time:"2023-03-02 05:21:35"}]},{name:"服务器与数据库",childrens:[{id:23,name:"导入测试参数1",describe:"导入测试参数描述1",level:1.5,superior:"导入测试参数所属业务1",enable:1,demonstrate:1,conflict:[],history:"null",layer:"功能要求||服务器与数据库",creat_time:"2023-03-02 05:24:31"},{id:24,name:"导入测试参数2",describe:"导入测试参数描述2",level:2.5,superior:"导入测试参数所属业务2",enable:1,demonstrate:1,conflict:[],history:"null",layer:"功能要求||服务器与数据库",creat_time:"2023-03-02 05:24:31"},{id:26,name:"导入测试参数4",describe:"导入测试参数描述4",level:4.5,superior:"导入测试参数所属业务4",enable:1,demonstrate:0,conflict:[],history:"null",layer:"功能要求||服务器与数据库",creat_time:"2023-03-02 05:24:31"}]},{name:"测试222",childrens:[{id:31,name:"测试11",describe:"123",level:4,superior:"123",enable:1,demonstrate:0,conflict:[],history:"",layer:"功能要求||测试222",creat_time:"2023-03-30 08:13:10"},{id:32,name:"导入测试参数11",describe:"导入测试参数描述1",level:1.5,superior:"导入测试参数所属业务1",enable:1,demonstrate:1,conflict:[],history:null,layer:"功能要求||测试222",creat_time:"2023-03-30 08:45:59"},{id:33,name:"导入测试参数22",describe:"导入测试参数描述2",level:2.5,superior:"导入测试参数所属业务2",enable:1,demonstrate:1,conflict:[],history:null,layer:"功能要求||测试222",creat_time:"2023-03-30 08:45:59"},{id:34,name:"导入测试参数33",describe:"导入测试参数描述3",level:3.5,superior:"导入测试参数所属业务3",enable:1,demonstrate:0,conflict:[],history:null,layer:"功能要求||测试222",creat_time:"2023-03-30 08:45:59"},{id:35,name:"导入测试参数44",describe:"导入测试参数描述4",level:4.5,superior:"导入测试参数所属业务4",enable:1,demonstrate:0,conflict:[],history:null,layer:"功能要求||测试222",creat_time:"2023-03-30 08:45:59"},{id:36,name:"导入测试参数55",describe:"导入测试参数描述5",level:4.5,superior:"导入测试参数所属业务5",enable:1,demonstrate:0,conflict:[],history:null,layer:"功能要求||测试222",creat_time:"2023-03-30 08:45:59"}]}],business:[{id:1,name:"测试商务参数",describe:"测试商务参数",attention:1,notice:"特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意特别注意",superior:"测试商务参数",enable:1,creat_time:"2023-03-02 05:44:51"},{id:2,name:"导入测试参数1",describe:"导入测试参数描述1",attention:1,notice:"导入测试参数所属业务1",superior:"导入测试参数描述1",enable:0,creat_time:"2023-03-02 06:03:06"},{id:3,name:"导入测试参数2",describe:"导入测试参数描述2",attention:1,notice:"导入测试参数所属业务2",superior:"导入测试参数描述2",enable:1,creat_time:"2023-03-02 06:03:06"},{id:5,name:"导入测试参数4",describe:"导入测试参数描述4",attention:0,notice:"导入测试参数所属业务4",superior:"导入测试参数描述4",enable:1,creat_time:"2023-03-02 06:03:06"}],review:[{id:1,name:"参数名称1",describe:"参数描述1",paratype:"参数类型1",superior:"所属业务11",enable:0,creat_time:"2023-03-02 06:38:57",score:"15"},{id:2,name:"参数名称2",describe:"参数描述2",paratype:"参数类型2",superior:"所属业务2",enable:1,creat_time:"2023-03-02 06:38:57",score:"30"},{id:3,name:"参数名称3",describe:"参数描述3",paratype:"参数类型3",superior:"所属业务3",enable:0,creat_time:"2023-03-02 06:38:57",score:"25"},{id:4,name:"参数名称4",describe:"参数描述4",paratype:"参数类型4",superior:"所属业务4",enable:1,creat_time:"2023-03-02 06:38:57",score:"30"}]}}}},components:{},methods:{},mounted(){},beforeMount(){this.$store.state.bidding.bidding_form=this.form},created(){}},U=t(3744);const C=(0,U.Z)(x,[["render",$]]);var S=C},3279:function(e,l,t){t.r(l),t.d(l,{default:function(){return d}});var a=t(6252);function i(e,l,t,i,o,s){const r=(0,a.up)("el-input"),d=(0,a.up)("el-form-item"),n=(0,a.up)("el-switch"),u=(0,a.up)("el-form"),m=(0,a.up)("el-button"),c=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(c,{title:o.titleMap[o.mode],modelValue:o.visible,"onUpdate:modelValue":l[8]||(l[8]=e=>o.visible=e),width:500,"destroy-on-close":"",onClosed:l[9]||(l[9]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(m,{onClick:l[6]||(l[6]=e=>o.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(m,{type:"primary",loading:o.isSaveing,onClick:l[7]||(l[7]=e=>s.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])])),default:(0,a.w5)((()=>[(0,a.Wm)(u,{model:o.form,rules:o.rules,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.name,"onUpdate:modelValue":l[0]||(l[0]=e=>o.form.name=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"描述",prop:"describe"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.describe,"onUpdate:modelValue":l[1]||(l[1]=e=>o.form.describe=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"特别注意",prop:"attention"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.attention,"onUpdate:modelValue":l[2]||(l[2]=e=>o.form.attention=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),1==o.form.attention?((0,a.wg)(),(0,a.j4)(d,{key:0,label:"注意点",prop:"notice"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.notice,"onUpdate:modelValue":l[3]||(l[3]=e=>o.form.notice=e),clearable:""},null,8,["modelValue"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(d,{label:"所属业务",prop:"superior"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.superior,"onUpdate:modelValue":l[4]||(l[4]=e=>o.form.superior=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"是否启用",prop:"enable"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.enable,"onUpdate:modelValue":l[5]||(l[5]=e=>o.form.enable=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var o={props:["data"],emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增参数",edit:"编辑参数"},form:{name:"",describe:"",superior:"",enable:1,attention:0,notice:""},rules:{name:[{required:!0,message:"请输入名称"}],describe:[{required:!0,message:"请输入描述"}],superior:[{required:!0,message:"请输入所属业务",trigger:"change"}]},index:0,visible:!1,isSaveing:!1}},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;try{await this.$API.params.business.updata.post(this.form),this.visible=!1,this.$emit("success"),this.$message.success("操作成功")}catch(l){}finally{this.isSaveing=!1}}}))},setData(e,l){this.index=l,this.form=this.$TOOL.objCopy(e)},selectParms(e,l){for(let t of this.data)if(t.id==e){this.form.conflict[l]["superior"]=t.superior,this.form.conflict[l]["name"]=t.name;break}}}},s=t(3744);const r=(0,s.Z)(o,[["render",i]]);var d=r},6757:function(e,l,t){t.r(l),t.d(l,{default:function(){return d}});var a=t(6252);function i(e,l,t,i,o,s){const r=(0,a.up)("el-input"),d=(0,a.up)("el-form-item"),n=(0,a.up)("el-switch"),u=(0,a.up)("el-form"),m=(0,a.up)("el-button"),c=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(c,{title:o.titleMap[o.mode],modelValue:o.visible,"onUpdate:modelValue":l[7]||(l[7]=e=>o.visible=e),width:500,"destroy-on-close":"",onClosed:l[8]||(l[8]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(m,{onClick:l[5]||(l[5]=e=>o.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(m,{type:"primary",loading:o.isSaveing,onClick:l[6]||(l[6]=e=>s.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])])),default:(0,a.w5)((()=>[(0,a.Wm)(u,{model:o.form,rules:o.rules,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.name,"onUpdate:modelValue":l[0]||(l[0]=e=>o.form.name=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"描述",prop:"describe"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.describe,"onUpdate:modelValue":l[1]||(l[1]=e=>o.form.describe=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"类型",prop:"paratype"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.paratype,"onUpdate:modelValue":l[2]||(l[2]=e=>o.form.paratype=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"所属业务",prop:"superior"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.superior,"onUpdate:modelValue":l[3]||(l[3]=e=>o.form.superior=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"是否启用",prop:"enable"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.enable,"onUpdate:modelValue":l[4]||(l[4]=e=>o.form.enable=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var o={props:["data"],emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增参数",edit:"编辑参数"},form:{name:"",describe:"",superior:"",enable:1,paratype:""},rules:{name:[{required:!0,message:"请输入名称"}],describe:[{required:!0,message:"请输入描述"}],paratype:[{required:!0,message:"请输入描述"}],superior:[{required:!0,message:"请输入所属业务",trigger:"change"}]},index:0,visible:!1,isSaveing:!1}},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;try{await this.$API.params.review.updata.post(this.form),this.visible=!1,this.$emit("success"),this.$message.success("操作成功")}catch(l){}finally{this.isSaveing=!1}}}))},setData(e,l){this.index=l,this.form=this.$TOOL.objCopy(e)},selectParms(e,l){for(let t of this.data)if(t.id==e){this.form.conflict[l]["superior"]=t.superior,this.form.conflict[l]["name"]=t.name;break}}}},s=t(3744);const r=(0,s.Z)(o,[["render",i]]);var d=r},7146:function(e,l,t){t.r(l),t.d(l,{default:function(){return u}});var a=t(6252),i=t(3577);const o={class:"flex-bc"};function s(e,l,t,s,r,d){const n=(0,a.up)("el-input"),u=(0,a.up)("el-form-item"),m=(0,a.up)("el-rate"),c=(0,a.up)("el-switch"),p=(0,a.up)("el-option"),f=(0,a.up)("el-select"),h=(0,a.up)("el-icon-circle-check"),b=(0,a.up)("el-icon"),g=(0,a.up)("el-table-column"),w=(0,a.up)("sc-form-table"),v=(0,a.up)("el-form"),_=(0,a.up)("el-button"),y=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(y,{title:r.titleMap[r.mode],modelValue:r.visible,"onUpdate:modelValue":l[11]||(l[11]=e=>r.visible=e),width:500,"destroy-on-close":"",onClosed:l[12]||(l[12]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(_,{onClick:l[9]||(l[9]=e=>r.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(_,{type:"primary",loading:r.isSaveing,onClick:l[10]||(l[10]=e=>d.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])])),default:(0,a.w5)((()=>[(0,a.Wm)(v,{model:r.form,rules:r.rules,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{label:"名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:r.form.name,"onUpdate:modelValue":l[0]||(l[0]=e=>r.form.name=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"描述",prop:"describe"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:r.form.describe,"onUpdate:modelValue":l[1]||(l[1]=e=>r.form.describe=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"特色级别",prop:"level"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{modelValue:r.form.level,"onUpdate:modelValue":l[2]||(l[2]=e=>r.form.level=e),size:"small","allow-half":""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"所属业务",prop:"superior"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:r.form.superior,"onUpdate:modelValue":l[3]||(l[3]=e=>r.form.superior=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"是否启用",prop:"enable"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:r.form.enable,"onUpdate:modelValue":l[4]||(l[4]=e=>r.form.enable=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"演示参数",prop:"demonstrate"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:r.form.demonstrate,"onUpdate:modelValue":l[5]||(l[5]=e=>r.form.demonstrate=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"层级",prop:"layer"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:r.form.layer,"onUpdate:modelValue":l[7]||(l[7]=e=>r.form.layer=e),clearable:""},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{modelValue:r.layer_select,"onUpdate:modelValue":l[6]||(l[6]=e=>r.layer_select=e),placeholder:"请选择",style:{width:"115px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"功能要求",value:"功能要求"}),(0,a.Wm)(p,{label:"框架要求",value:"框架要求"})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(u,{label:"冲突项",prop:"conflict"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{modelValue:r.form.conflict,"onUpdate:modelValue":l[8]||(l[8]=e=>r.form.conflict=e),addTemplate:{id:"",name:"",superior:""},placeholder:"暂无数据"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{prop:"id",label:"冲突参数(仅同层级)"},{default:(0,a.w5)((e=>[(0,a.Wm)(f,{modelValue:e.row.id,"onUpdate:modelValue":l=>e.row.id=l,filterable:"",placeholder:"输入文字可搜索",onChange:l=>d.selectParms(l,e.$index)},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.data,(e=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e.id},[d.option_filter(e)?((0,a.wg)(),(0,a.j4)(p,{key:0,disabled:!d.option_check(e.name),label:e.name,value:e.id},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a._)("span",null,(0,i.zw)(e.name),1),d.option_check(e.name)?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(b,{key:0,color:"#e2462c"},{default:(0,a.w5)((()=>[(0,a.Wm)(h)])),_:1}))])])),_:2},1032,["disabled","label","value"])):(0,a.kq)("",!0)],64)))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,a.Wm)(g,{prop:"superior",label:"所属业务",width:"80"},{default:(0,a.w5)((e=>[(0,a._)("span",null,(0,i.zw)(e.row.superior),1)])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}t(7658);var r={props:["data"],emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增参数",edit:"编辑参数"},form:{name:"",describe:"",level:1.5,superior:"",enable:1,demonstrate:0,conflict:[],history:"",layer:""},rules:{name:[{required:!0,message:"请输入名称"}],describe:[{required:!0,message:"请输入描述"}],level:[{required:!0,message:"请输入特色级别"}],superior:[{required:!0,message:"请输入所属业务",trigger:"change"}],conflict:[{validator:this.conflict_check,trigger:"blur"}],layer:[{required:!0,message:"请输入层级",trigger:"blur"}]},index:0,visible:!1,isSaveing:!1,conflict_back:[],layer_select:"功能要求",layer_text:""}},mounted(){},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},conflict_check(e,l,t){for(let a of l)if(""==a.id)return t(new Error("请选择"));t()},async conflict_modification(){let e=JSON.stringify(this.conflict_back)===JSON.stringify(this.form.conflict);if(e)return console.log("无修改"),!1;for(let l of this.data)if(this.option_filter(l)){let e=!1;for(let t of this.form.conflict)if(t.id==l.id){for(let t of l.conflict)if(t.id==this.form.id){e=!0;break}if(e)break;console.log("添加对应冲突项:",l,t);let a=this.$TOOL.objCopy(l.conflict);a.push({id:this.form.id,name:this.form.name,superior:this.form.superior});let i={id:l.id,conflict:a};await this.technical_updata(i)}if(e)continue;for(let t in l.conflict){let e=l.conflict[t];if(this.form.id==e.id){console.log("删除对应冲突项:",l,e);let a=this.$TOOL.objCopy(l.conflict);a.splice(t,1);let i={id:l.id,conflict:a};await this.technical_updata(i);break}}}},async technical_updata(e){try{return await this.$API.params.technical.updata.post(e),!0}catch(l){return!1}},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;try{await this.conflict_modification();let e=this.$TOOL.objCopy(this.form);e.layer=`${this.layer_select}||${e.layer}`,console.log("参数:",e),await this.$API.params.technical.updata.post(e),this.visible=!1,this.$emit("success"),this.$message.success("操作成功")}catch(l){}finally{this.isSaveing=!1}}}))},setData(e,l){this.index=l,this.form=this.$TOOL.objCopy(e);let t=e["layer"].split("||");this.layer_select=t[0],this.form.layer=t[1],this.conflict_back=this.$TOOL.objCopy(e.conflict)},selectParms(e,l){for(let t of this.data)if(t.id==e){this.form.conflict[l]["superior"]=t.superior,this.form.conflict[l]["name"]=t.name;break}},option_filter(e){let l=e.layer.split("||")[1],t=l==this.form.layer&&e.id!=this.form.id;return t},option_check(e){for(let l of this.form.conflict)if(e==l.name)return!1;return!0}}},d=t(3744);const n=(0,d.Z)(r,[["render",s]]);var u=n},4596:function(e,l,t){t.r(l),t.d(l,{default:function(){return d}});var a=t(6252);function i(e,l,t,i,o,s){const r=(0,a.up)("el-option"),d=(0,a.up)("el-select"),n=(0,a.up)("el-form-item"),u=(0,a.up)("el-input"),m=(0,a.up)("el-form"),c=(0,a.up)("el-button"),p=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(p,{title:o.titleMap[o.mode],modelValue:o.visible,"onUpdate:modelValue":l[5]||(l[5]=e=>o.visible=e),width:500,"destroy-on-close":"",onClosed:l[6]||(l[6]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(c,{onClick:l[3]||(l[3]=e=>o.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),"show"!=o.mode?((0,a.wg)(),(0,a.j4)(c,{key:0,type:"primary",loading:o.isSaveing,onClick:l[4]||(l[4]=e=>s.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])):(0,a.kq)("",!0)])),default:(0,a.w5)((()=>[(0,a.Wm)(m,{model:o.form,rules:o.rules,disabled:"show"==o.mode,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{label:"数据类型",prop:"type"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{modelValue:o.form.type,"onUpdate:modelValue":l[0]||(l[0]=e=>o.form.type=e),filterable:"",style:{width:"100%"}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.dataTypes,(e=>((0,a.wg)(),(0,a.j4)(r,{key:e.id,label:e.label,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(n,{label:"数据名称",prop:"alias"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.form.alias,"onUpdate:modelValue":l[1]||(l[1]=e=>o.form.alias=e),placeholder:"请输入数据名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(n,{label:"数值",prop:"value"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:o.form.value,"onUpdate:modelValue":l[2]||(l[2]=e=>o.form.value=e),placeholder:"请输入数值",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules","disabled"])])),_:1},8,["title","modelValue"])}var o={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增用户",edit:"编辑用户",show:"查看"},visible:!1,isSaveing:!1,form:{type:"",alias:"",value:""},dataTypes:[{id:"业务管理",label:"业务管理"},{id:"部门管理",label:"部门管理"},{id:"评审参数类型管理",label:"评审参数类型管理"},{id:"发票类型管理",label:"发票类型管理"}],rules:{type:[{required:!0,message:"请选择类型"}],alias:[{required:!0,message:"请输入名称"}]}}},mounted(){},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},choiceRole(e){for(let l of this.roles)if(l.id==e){this.form.roles=l.alias;break}},submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;try{this.isSaveing=!0;let e=Object.assign({},this.form);await this.$API.system.basedata.updata.post(e),this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")}catch(l){}this.isSaveing=!1}))},setData(e){Object.assign(this.form,e)}}},s=t(3744);const r=(0,s.Z)(o,[["render",i]]);var d=r},6701:function(e,l,t){t.r(l),t.d(l,{default:function(){return m}});var a=t(6252),i=t(3577);const o={class:"code break-all"},s={class:"code break-all"};function r(e,l,t,r,d,n){const u=(0,a.up)("el-descriptions-item"),m=(0,a.up)("el-descriptions"),c=(0,a.up)("el-alert"),p=(0,a.up)("el-collapse-item"),f=(0,a.up)("el-collapse"),h=(0,a.up)("el-main");return(0,a.wg)(),(0,a.j4)(h,{style:{padding:"0 20px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{column:1,border:"",size:"small"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{label:"操作用户"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(d.data.username),1)])),_:1}),(0,a.Wm)(u,{label:"请求ip"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(d.data.ip),1)])),_:1}),(0,a.Wm)(u,{label:"请求接口"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(d.data.url),1)])),_:1}),(0,a.Wm)(u,{label:"日志名"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(d.data.name),1)])),_:1}),(0,a.Wm)(u,{label:"日志时间"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(d.data.start_time),1)])),_:1})])),_:1}),(0,a.Wm)(f,{modelValue:d.activeNames,"onUpdate:modelValue":l[0]||(l[0]=e=>d.activeNames=e),style:{"margin-top":"20px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{title:"结果",name:"1"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{title:d.data.content,type:d.typeMap[d.data.level],closable:!1},null,8,["title","type"])])),_:1}),(0,a.Wm)(p,{title:"请求参数",name:"2"},{default:(0,a.w5)((()=>[(0,a._)("div",o,(0,i.zw)(d.data.params),1)])),_:1}),(0,a.Wm)(p,{title:"请求数据",name:"3"},{default:(0,a.w5)((()=>[(0,a._)("div",s,(0,i.zw)(d.data.data),1)])),_:1})])),_:1},8,["modelValue"])])),_:1})}var d={data(){return{data:{},activeNames:["1","2","3"],typeMap:{info:"info",warn:"warning",error:"error"}}},methods:{setData(e){this.data=e}}},n=t(3744);const u=(0,n.Z)(d,[["render",r],["__scopeId","data-v-7000178d"]]);var m=u},9977:function(e,l,t){t.r(l),t.d(l,{default:function(){return d}});var a=t(6252);function i(e,l,t,i,o,s){const r=(0,a.up)("el-input"),d=(0,a.up)("el-form-item"),n=(0,a.up)("el-switch"),u=(0,a.up)("el-table-column"),m=(0,a.up)("sc-form-table"),c=(0,a.up)("el-form"),p=(0,a.up)("el-button"),f=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(f,{title:o.titleMap[o.mode],modelValue:o.visible,"onUpdate:modelValue":l[8]||(l[8]=e=>o.visible=e),width:500,"destroy-on-close":"",onClosed:l[9]||(l[9]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(p,{onClick:l[6]||(l[6]=l=>e.$emit("closed"))},{default:(0,a.w5)((()=>[(0,a.Uk)("关 闭")])),_:1}),"show"!=o.mode?((0,a.wg)(),(0,a.j4)(p,{key:0,type:"primary",loading:o.isSaveing,onClick:l[7]||(l[7]=e=>s.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])):(0,a.kq)("",!0)])),default:(0,a.w5)((()=>[(0,a.Wm)(c,{model:o.form,rules:o.rules,disabled:"show"==o.mode,ref:"dialogForm","label-width":"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"菜单名称",prop:"meta"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.meta.title,"onUpdate:modelValue":l[0]||(l[0]=e=>o.form.meta.title=e),placeholder:"菜单名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"状态",prop:"enble"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.meta.enble,"onUpdate:modelValue":l[1]||(l[1]=e=>o.form.meta.enble=e),onChange:s.changeEnble,"active-value":!0,"inactive-value":!1},null,8,["modelValue","onChange"])])),_:1}),(0,a.Wm)(d,{label:"权限名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.name,"onUpdate:modelValue":l[2]||(l[2]=e=>o.form.name=e),placeholder:"权限名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"路径",prop:"path"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.path,"onUpdate:modelValue":l[3]||(l[3]=e=>o.form.path=e),placeholder:"路径",clearable:""},null,8,["modelValue"])])),_:1}),o.form.children?((0,a.wg)(),(0,a.j4)(d,{key:1,label:"子路由",prop:"path"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{modelValue:o.form.children,"onUpdate:modelValue":l[5]||(l[5]=e=>o.form.children=e),addEnble:!1,placeholder:"暂无数据"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{prop:"meta",label:"路由标题",width:"150"},{default:(0,a.w5)((e=>[(0,a.Wm)(r,{modelValue:e.row.meta.title,"onUpdate:modelValue":l=>e.row.meta.title=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(u,{prop:"path",label:"路由地址",width:"150"},{default:(0,a.w5)((e=>[(0,a.Wm)(r,{modelValue:e.row.path,"onUpdate:modelValue":l=>e.row.path=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(u,{prop:"name",label:"权限名称",width:"150"},{default:(0,a.w5)((e=>[(0,a.Wm)(r,{modelValue:e.row.name,"onUpdate:modelValue":l=>e.row.name=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(u,{prop:"组件地址",label:"路由地址",width:"150"},{default:(0,a.w5)((e=>[(0,a.Wm)(r,{modelValue:e.row.component,"onUpdate:modelValue":l=>e.row.component=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["modelValue"])])),_:1})):((0,a.wg)(),(0,a.j4)(d,{key:0,label:"细分权限",prop:"path"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{modelValue:o.form.meta.roles,"onUpdate:modelValue":l[4]||(l[4]=e=>o.form.meta.roles=e),addTemplate:{title:"",name:""},placeholder:"暂无数据"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{prop:"title",label:"权限标题",width:"80"},{default:(0,a.w5)((e=>[(0,a.Wm)(r,{modelValue:e.row.title,"onUpdate:modelValue":l=>e.row.title=l,placeholder:"请输入权限标题"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(u,{prop:"name",label:"权限名称"},{default:(0,a.w5)((e=>[(0,a.Wm)(r,{modelValue:e.row.name,"onUpdate:modelValue":l=>e.row.name=l,placeholder:"请输入权限名称"},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["modelValue"])])),_:1}))])),_:1},8,["model","rules","disabled"])])),_:1},8,["title","modelValue"])}var o={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增",edit:"编辑",show:"查看"},visible:!1,isSaveing:!1,form:{meta:{title:"",roles:""}},formBack:{},rules:{sort:[{required:!0,message:"请输入排序",trigger:"change"}],label:[{required:!0,message:"请输入部门名称"}]},groups:[],groupsProps:{value:"id",emitPath:!1,checkStrictly:!0},index:0}},mounted(){},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{e&&(this.$emit("success",this.form,this.index),this.visible=!1,this.$message.success("操作成功"))}))},changeEnble(){},setData(e,l){this.index=l,this.form=this.$TOOL.objCopy(e)}}},s=t(3744);const r=(0,s.Z)(o,[["render",i]]);var d=r},2222:function(e,l,t){t.r(l),t.d(l,{default:function(){return n}});var a=t(6252);const i={class:"treeMain"};function o(e,l,t,o,s,r){const d=(0,a.up)("el-tree"),n=(0,a.up)("el-tab-pane"),u=(0,a.up)("el-tabs"),m=(0,a.up)("el-button"),c=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(c,{title:"角色权限设置",modelValue:s.visible,"onUpdate:modelValue":l[2]||(l[2]=e=>s.visible=e),width:500,"destroy-on-close":"",onClosed:l[3]||(l[3]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(m,{onClick:l[0]||(l[0]=e=>s.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(m,{type:"primary",loading:s.isSaveing,onClick:l[1]||(l[1]=e=>r.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])])),default:(0,a.w5)((()=>[(0,a.Wm)(u,{"tab-position":"top"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{label:"菜单权限"},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.Wm)(d,{ref:"menu","node-key":"name",data:s.menu.list,props:s.menu.props,"show-checkbox":""},null,8,["data","props"])])])),_:1})])),_:1})])),_:1},8,["modelValue"])}t(7658);var s={props:["auths"],emits:["success","closed","update"],data(){return{visible:!1,isSaveing:!1,menu:{list:[],checked:[],props:{label:e=>e.title}}}},mounted(){},methods:{open(){this.visible=!0},setChecked(e){this.menu.checked=e},submit(){var e=this.$refs.menu.getCheckedKeys().concat(this.$refs.menu.getHalfCheckedKeys());console.log(e),setTimeout((()=>{this.isSaveing=!1,this.visible=!1,this.$message.success("已选择"),this.$emit("update",e)}),1e3)},async getMenu(){const e=l=>{let t=[];for(let a of l)t.push(a.name),a.children&&(t=t.concat(e(a.children)));return t};var l=await this.$API.system.role.auth.get();this.menu.list=l.data;let t=JSON.parse(this.auths);if(t.includes("*")){let l=e(this.menu.list);this.menu.checked=l}else this.menu.checked=t;this.$nextTick((()=>{let e=this.menu.checked.filter((e=>this.$refs.menu.getNode(e).isLeaf));this.$refs.menu.setCheckedKeys(e,!0)}))}}},r=t(3744);const d=(0,r.Z)(s,[["render",o],["__scopeId","data-v-577e8dc4"]]);var n=d},2383:function(e,l,t){t.r(l),t.d(l,{default:function(){return u}});var a=t(6252);const i={class:"flex-c w-full gap-1.5"};function o(e,l,t,o,s,r){const d=(0,a.up)("el-input"),n=(0,a.up)("el-form-item"),u=(0,a.up)("el-button"),m=(0,a.up)("el-form"),c=(0,a.up)("el-dialog"),p=(0,a.up)("permission-dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":l[7]||(l[7]=e=>s.visible=e),width:500,"destroy-on-close":"",onClosed:l[8]||(l[8]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(u,{onClick:l[5]||(l[5]=e=>s.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),"show"!=s.mode?((0,a.wg)(),(0,a.j4)(u,{key:0,type:"primary",loading:s.isSaveing,onClick:l[6]||(l[6]=e=>r.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])):(0,a.kq)("",!0)])),default:(0,a.w5)((()=>[(0,a.Wm)(m,{model:s.form,rules:s.rules,disabled:"show"==s.mode,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{label:"角色名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{modelValue:s.form.name,"onUpdate:modelValue":l[0]||(l[0]=e=>s.form.name=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(n,{label:"角色别名",prop:"alias"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{modelValue:s.form.alias,"onUpdate:modelValue":l[1]||(l[1]=e=>s.form.alias=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(n,{label:"权限",prop:"auths"},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.Wm)(d,{modelValue:s.form.auths,"onUpdate:modelValue":l[2]||(l[2]=e=>s.form.auths=e),clearable:"",type:"textarea",disabled:""},null,8,["modelValue"]),(0,a.Wm)(u,{onClick:r.set_permission},{default:(0,a.w5)((()=>[(0,a.Uk)("设置")])),_:1},8,["onClick"])])])),_:1}),(0,a.Wm)(n,{label:"备注",prop:"remark"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{modelValue:s.form.remark,"onUpdate:modelValue":l[3]||(l[3]=e=>s.form.remark=e),clearable:"",type:"textarea"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(n,{label:"创建时间",prop:"creat_time"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{modelValue:s.form.creat_time,"onUpdate:modelValue":l[4]||(l[4]=e=>s.form.creat_time=e),clearable:"",disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules","disabled"])])),_:1},8,["title","modelValue"]),s.permission?((0,a.wg)(),(0,a.j4)(p,{key:0,auths:s.form.auths,onUpdate:r.update_permission,ref:"permissionDialog",onClosed:l[9]||(l[9]=e=>s.permission=!1)},null,8,["auths","onUpdate"])):(0,a.kq)("",!0)],64)}var s=t(2222),r={emits:["success","closed"],components:{permissionDialog:s["default"]},data(){return{mode:"add",permission:!1,titleMap:{add:"新增",edit:"编辑",show:"查看"},visible:!1,isSaveing:!1,form:{},rules:{auths:[{required:!0,message:"请选择权限",trigger:"blur"}],name:[{required:!0,message:"请输入角色名称"}],alias:[{required:!0,message:"请输入角色别名"}]}}},mounted(){},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;try{var l=await this.$API.system.role.updata.post(this.form);200==l.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功,权限相关人员重新登陆后生效")):this.$alert(l.message,"提示",{type:"error"})}finally{this.isSaveing=!1}}}))},set_permission(){this.permission=!0,this.$nextTick((()=>{this.$refs.permissionDialog.open(),this.$refs.permissionDialog.getMenu()}))},update_permission(e){this.form.auths=JSON.stringify(e)},setData(e){Object.assign(this.form,e)}}},d=t(3744);const n=(0,d.Z)(r,[["render",o]]);var u=n},8169:function(e,l,t){t.r(l),t.d(l,{default:function(){return d}});var a=t(6252);function i(e,l,t,i,o,s){const r=(0,a.up)("el-input"),d=(0,a.up)("el-form-item"),n=(0,a.up)("el-input-number"),u=(0,a.up)("el-option"),m=(0,a.up)("el-select"),c=(0,a.up)("el-switch"),p=(0,a.up)("el-form"),f=(0,a.up)("el-button"),h=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(h,{title:o.titleMap[o.mode],modelValue:o.visible,"onUpdate:modelValue":l[11]||(l[11]=e=>o.visible=e),width:500,"destroy-on-close":"",onClosed:l[12]||(l[12]=l=>e.$emit("closed"))},{footer:(0,a.w5)((()=>[(0,a.Wm)(f,{onClick:l[9]||(l[9]=e=>o.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),"show"!=o.mode?((0,a.wg)(),(0,a.j4)(f,{key:0,type:"primary",loading:o.isSaveing,onClick:l[10]||(l[10]=e=>s.submit())},{default:(0,a.w5)((()=>[(0,a.Uk)("保 存")])),_:1},8,["loading"])):(0,a.kq)("",!0)])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{model:o.form,rules:o.rules,disabled:"show"==o.mode,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"登录名",prop:"username"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.username,"onUpdate:modelValue":l[0]||(l[0]=e=>o.form.username=e),placeholder:"用于登录系统",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.name,"onUpdate:modelValue":l[1]||(l[1]=e=>o.form.name=e),placeholder:"名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"登录密码",prop:"password"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{type:"password",modelValue:o.form.password,"onUpdate:modelValue":l[2]||(l[2]=e=>o.form.password=e),clearable:"","show-password":""},null,8,["modelValue"])])),_:1}),"add"==o.mode?((0,a.wg)(),(0,a.j4)(d,{key:0,label:"确认密码",prop:"password2"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{type:"password",modelValue:o.form.password2,"onUpdate:modelValue":l[3]||(l[3]=e=>o.form.password2=e),clearable:"","show-password":""},null,8,["modelValue"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(d,{label:"联系方式",prop:"contact"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:o.form.phone,"onUpdate:modelValue":l[4]||(l[4]=e=>o.form.phone=e),placeholder:"联系方式",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"余额",prop:"card_cash"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.card_cash,"onUpdate:modelValue":l[5]||(l[5]=e=>o.form.card_cash=e),placeholder:"余额",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"折扣",prop:"discount"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:o.form.discount,"onUpdate:modelValue":l[6]||(l[6]=e=>o.form.discount=e),placeholder:"折扣 %",clearable:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"所属角色",prop:"roleid"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{modelValue:o.form.roleid,"onUpdate:modelValue":l[7]||(l[7]=e=>o.form.roleid=e),filterable:"",style:{width:"100%"},onChange:s.choiceRole},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.roles,(e=>((0,a.wg)(),(0,a.j4)(u,{key:e.id,label:e.alias,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,a.Wm)(d,{label:"是否启用",prop:"sign"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:o.form.sign,"onUpdate:modelValue":l[8]||(l[8]=e=>o.form.sign=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules","disabled"])])),_:1},8,["title","modelValue"])}var o={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"新增用户",edit:"编辑用户",show:"查看"},visible:!1,isSaveing:!1,form:{username:"",name:"",password:"",password2:"",contact:"",card_cash:0,discount:100,roles:"",sign:1,roleid:""},rules:{username:[{required:!0,message:"请输入登录账号"}],name:[{required:!0,message:"请输入真实姓名"}],password:[{required:!0,message:"请输入登录密码"},{validator:(e,l,t)=>{""!==this.form.password2&&this.$refs.dialogForm.validateField("password2"),t()}}],password2:[{required:!0,message:"请再次输入密码"},{validator:(e,l,t)=>{l!==this.form.password?t(new Error("两次输入密码不一致!")):t()}}],phone:[{required:!0,message:"请输入手机号"}],certificate_type:[{required:!0,message:"请选择类型"}],id_number:[{required:!0,message:"请输入证件号"}],department:[{required:!0,message:"请输入公司与部门"}],roleid:[{required:!0,message:"请选择所属角色",trigger:"change"}]},roles:[],rolesProps:{value:"id",multiple:!0,checkStrictly:!0}}},mounted(){this.getRoles(),this.getDept()},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},choiceRole(e){for(let l of this.roles)if(l.id==e){this.form.roles=l.alias;break}},async getRoles(){let e={page:1,pageSize:100};var l=await this.$API.system.role.list.get(e);this.roles=l.data.rows},async getDept(){},submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;try{this.isSaveing=!0;let e=Object.assign({},this.form);delete e["password2"],await this.$API.system.user.updata.post(e),this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")}catch(l){}this.isSaveing=!1}))},setData(e){Object.assign(this.form,e)}}},s=t(3744);const r=(0,s.Z)(o,[["render",i]]);var d=r}}]);